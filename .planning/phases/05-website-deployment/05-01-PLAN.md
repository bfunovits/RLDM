---
phase: 05-website-deployment
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [inst/_pkgdown.yml]
autonomous: true

must_haves:
  truths:
    - "pkgdown configuration references only documented functions"
    - "GitHub Actions workflow is correctly configured for automatic deployment"
  artifacts:
    - path: "inst/_pkgdown.yml"
      provides: "pkgdown configuration without invalid references"
      contains: "reference:" (but not "outputs_ARMA_cpp", "outputs_STSP_cpp", "residuals_ARMA_cpp", "residuals_STSP_cpp", "cll_theta_ARMA_cpp", "cll_theta_STSP_cpp", "fbsolve_STSP_cpp", "solve_rmfd_cpp", "ll_kf_theta_cpp", "rls_exp_cpp")
    - path: ".github/workflows/pkgdown.yaml"
      provides: "GitHub Actions deployment workflow"
      contains: "pkgdown::build_site_github_pages"
  key_links:
    - from: "inst/_pkgdown.yml"
      to: "valid documentation"
      via: "function references"
      pattern: "only exported functions with Rd files"
    - from: ".github/workflows/pkgdown.yaml"
      to: "docs/ directory"
      via: "Build site step"
      pattern: "pkgdown::build_site_github_pages"
---

<objective>
Fix pkgdown configuration to remove references to internal C++ functions without Rd documentation, and verify GitHub Actions workflow is correctly configured.

Purpose: Ensure pkgdown website builds locally without errors by fixing invalid function references in configuration.
Output: Updated inst/_pkgdown.yml without internal C++ function references, verified GitHub Actions workflow
</objective>

<execution_context>
@/home/bernd/.claude/get-shit-done/workflows/execute-plan.md
@/home/bernd/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-website-deployment/05-CONTEXT.md
@.planning/phases/05-website-deployment/05-RESEARCH.md

# Research identified 10 internal C++ functions referenced in pkgdown config without Rd documentation:
# - outputs_ARMA_cpp
# - outputs_STSP_cpp
# - residuals_ARMA_cpp
# - residuals_STSP_cpp
# - cll_theta_ARMA_cpp
# - cll_theta_STSP_cpp
# - fbsolve_STSP_cpp
# - solve_rmfd_cpp
# - ll_kf_theta_cpp
# - rls_exp_cpp
# These should be removed from inst/_pkgdown.yml
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify GitHub Actions workflow configuration</name>
  <files>.github/workflows/pkgdown.yaml</files>
  <action>
1. Read the existing GitHub Actions workflow at `.github/workflows/pkgdown.yaml`
2. Verify it follows standard pkgdown deployment pattern:
   - Triggers on push to main/master branches
   - Uses r-lib/actions setup for R and dependencies
   - Installs pkgdown and package dependencies
   - Runs `pkgdown::build_site_github_pages(new_process = FALSE, install = FALSE)`
   - Deploys to gh-pages branch using JamesIves/github-pages-deploy-action
3. Check for any issues:
   - Missing permissions (contents: write)
   - Incorrect branch names
   - Missing dependency installation (rationalmatrices sister package)
   - Incorrect build command options
4. Document any findings but DO NOT modify unless absolutely necessary (workflow is already working based on research)
  </action>
  <verify>Workflow file exists and contains standard pkgdown deployment pattern</verify>
  <done>GitHub Actions workflow verified as correctly configured for automatic deployment</done>
</task>

<task type="auto">
  <name>Task 2: Fix pkgdown configuration to remove invalid references</name>
  <files>inst/_pkgdown.yml</files>
  <action>
1. Read the current `inst/_pkgdown.yml` configuration
2. Identify and remove all internal C++ function references that lack Rd documentation:

   **Section: "RcppArmadillo Implementations - Solving" (lines 100-109)**
   - outputs_ARMA_cpp
   - outputs_STSP_cpp
   - residuals_ARMA_cpp
   - residuals_STSP_cpp
   - cll_theta_ARMA_cpp
   - cll_theta_STSP_cpp
   - fbsolve_STSP_cpp
   - solve_rmfd_cpp

   **Section: "Estimation Methods - Likelihood Based" (line 136)**
   - ll_kf_theta_cpp

   **Section: "Estimation Methods - Recursive Least Squares" (line 140)**
   - rls_exp_cpp

3. Options for handling empty sections:
   - Option A: Remove the entire "RcppArmadillo Implementations - Solving" section if it becomes empty
   - Option B: Keep section title but with empty contents (not valid YAML)
   - Option C: Replace with actual documented wrapper functions if appropriate

   **Choose Option A for "RcppArmadillo Implementations - Solving":** Remove the entire section since these are internal C++ functions without public documentation. The wrapper functions (kf(), ll_kf(), etc.) are already documented elsewhere.

   **For "Estimation Methods - Likelihood Based":** Simply remove the `ll_kf_theta_cpp` entry, leaving the other documented functions (est_ML, ll, ll_FUN, ll_theta, ll_kf).

   **For "Estimation Methods - Recursive Least Squares":** Simply remove the `rls_exp_cpp` entry, leaving the documented `arx_rls_core` function.

4. Save the updated configuration
5. Verify the YAML is still valid (no syntax errors)
  </action>
  <verify>Updated inst/_pkgdown.yml no longer contains references to outputs_ARMA_cpp, outputs_STSP_cpp, residuals_ARMA_cpp, residuals_STSP_cpp, cll_theta_ARMA_cpp, cll_theta_STSP_cpp, fbsolve_STSP_cpp, solve_rmfd_cpp, ll_kf_theta_cpp, rls_exp_cpp</verify>
  <done>pkgdown configuration fixed with all invalid references removed, ready for local build test</done>
</task>

</tasks>

<verification>
1. Check that `.github/workflows/pkgdown.yaml` follows standard patterns
2. Verify `inst/_pkgdown.yml` no longer references internal C++ functions without Rd documentation
3. Confirm YAML syntax is valid after modifications
</verification>

<success_criteria>
- GitHub Actions workflow verified as correctly configured
- pkgdown configuration fixed (all invalid references removed)
- Configuration ready for local build test in next plan
</success_criteria>

<output>
After completion, create `.planning/phases/05-website-deployment/05-01-SUMMARY.md`
</output>
