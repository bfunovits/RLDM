---
phase: 02-code-organization
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: 
  - src/kf.cpp
  - src/rls_core.cpp
  - src/solve_fwd_bwd_cll.cpp
  - src/pf.cpp
autonomous: true

must_haves:
  truths:
    - "C++ functions have Doxygen-style documentation with @param, @return, @brief tags"
    - "C++ code follows Google C++ Style Guide formatting (2-space indentation, 80-char lines, snake_case)"
    - "C++ variable names are consistent and follow naming conventions"
    - "Roxygen comments (//') are replaced with Doxygen comments (/** */) for C++ functions"
  artifacts:
    - path: "src/kf.cpp"
      provides: "Kalman filter implementation with proper documentation"
      contains: "/** @brief */ documentation blocks"
    - path: "src/rls_core.cpp"
      provides: "Recursive least squares implementation with proper documentation"
      contains: "Doxygen-style function documentation"
    - path: "src/solve_fwd_bwd_cll.cpp"
      provides: "Forward-backward solving with proper documentation"
      contains: "Google C++ Style Guide compliant formatting"
    - path: "src/pf.cpp"
      provides: "Particle filter implementation with proper documentation"
      contains: "Consistent snake_case naming"
  key_links:
    - from: "Doxygen documentation blocks"
      to: "Function parameters and return values"
      via: "@param and @return tags"
      pattern: "@param.*@return"
    - from: "Google C++ Style Guide"
      to: "All C++ source files"
      via: "Consistent formatting and naming"
      pattern: "2-space indentation, 80-char lines"
---

<objective>
Add Doxygen documentation and apply Google C++ Style Guide formatting to all C++ source files in src/.

Purpose: Improve code maintainability and reduce cognitive overhead by following established C++ standards. Doxygen documentation provides clear API documentation, while Google C++ Style Guide ensures consistent formatting and naming.

Output: All C++ files (kf.cpp, rls_core.cpp, solve_fwd_bwd_cll.cpp, pf.cpp) with proper Doxygen documentation and consistent style.
</objective>

<execution_context>
@/home/bernd/.claude/get-shit-done/workflows/execute-plan.md
@/home/bernd/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-code-organization/02-RESEARCH.md
@.planning/phases/02-code-organization/02-CONTEXT.md

# C++ code standards from research
- Use Doxygen-style comments (/** */) with @param, @return, @brief tags
- Follow Google C++ Style Guide: 2-space indentation, 80-character line limit, snake_case for functions/variables
- Replace Roxygen comments (//') with Doxygen for C++ functions
- Maintain existing functionality - only documentation and formatting changes
</context>

<tasks>

<task type="auto">
  <name>Task 1: Document kf.cpp with Doxygen and apply Google C++ style</name>
  <files>src/kf.cpp</files>
  <action>
1. Read the entire kf.cpp file to understand its structure and functions
2. For each C++ function (kf_cpp and any helper functions):
   - Replace Roxygen comments (//') with Doxygen comments (/** */)
   - Add @brief tag with one-line function description
   - Add @param tags for all parameters with descriptions
   - Add @return tag describing the return value
   - Add @note tags for important implementation details
3. Apply Google C++ Style Guide formatting:
   - Ensure 2-space indentation (no tabs)
   - Break lines longer than 80 characters
   - Use snake_case for function and variable names
   - Ensure braces follow Google style (same line for functions, new line for control statements)
   - Add spaces around operators and after commas
4. Verify the file still compiles by running a quick test:
   - Save the file
   - Run `Rcpp::compileAttributes()` in R to regenerate exports if needed
   - Check for obvious syntax errors

Example transformation:
Current: `//' @name kf` → `/** @brief Kalman filter implementation */`
Current: `Rcpp::List kf_cpp(const arma::mat& A, ...)` → Keep same signature but ensure proper Doxygen documentation

Important: Do NOT change the function signatures or algorithm logic - only documentation and formatting.
  </action>
  <verify>
- Open src/kf.cpp and verify:
  - All functions have Doxygen-style documentation blocks (/** */)
  - Each function has @brief, @param for all parameters, @return tags
  - No Roxygen comments (//') remain for function documentation
  - Code uses 2-space indentation consistently
  - Lines are under 80 characters (except where breaking would harm readability)
  - Variable and function names use snake_case
- Run quick syntax check: `R CMD check --no-manual --no-vignettes --no-build-vignettes .` should not show C++ syntax errors
  </verify>
  <done>
- kf.cpp has complete Doxygen documentation for all functions
- kf.cpp follows Google C++ Style Guide formatting
- File compiles without syntax errors
- No functional changes to the Kalman filter algorithm
  </done>
</task>

<task type="auto">
  <name>Task 2: Document rls_core.cpp with Doxygen and apply consistent style</name>
  <files>src/rls_core.cpp</files>
  <action>
1. Read rls_core.cpp to understand its functions (rls_exp_cpp, etc.)
2. Apply the same documentation and formatting standards:
   - Replace any Roxygen comments with Doxygen
   - Add complete @param, @return, @brief documentation
   - Apply Google C++ Style Guide formatting
   - Ensure consistent snake_case naming
3. Pay attention to:
   - Function parameters documentation
   - Return value descriptions
   - Any mathematical formulas or algorithms that need @note explanations
4. Verify compilation:
   - Save file
   - Ensure no syntax errors
   - Check that function signatures remain unchanged

Note: rls_core.cpp implements recursive least squares with exponential forgetting and windowed variants. Document the algorithm purpose and parameters clearly.
  </action>
  <verify>
- Open src/rls_core.cpp and check:
  - Doxygen documentation blocks exist for all functions
  - @param tags describe each parameter's purpose and dimensions
  - @return tags explain the return value structure
  - Code follows 2-space indentation, 80-char line limit
  - Consistent snake_case naming throughout
- Verify no compilation errors would occur
  </verify>
  <done>
- rls_core.cpp has complete Doxygen documentation
- Code follows Google C++ Style Guide
- All recursive least squares functions are properly documented
- No algorithm changes made
  </done>
</task>

<task type="auto">
  <name>Task 3: Document solve_fwd_bwd_cll.cpp and pf.cpp with same standards</name>
  <files>src/solve_fwd_bwd_cll.cpp, src/pf.cpp</files>
  <action>
1. Process solve_fwd_bwd_cll.cpp:
   - This implements forward-backward solving with conditional log-likelihood
   - Add Doxygen documentation for all functions
   - Apply Google C++ style formatting
   - Ensure parameter documentation includes matrix dimensions

2. Process pf.cpp (particle filter):
   - Add Doxygen documentation for particle filter functions
   - Document the different particle filter variants (SIR, APF)
   - Apply consistent formatting and naming

3. For both files:
   - Maintain existing Rcpp export attributes (// [[Rcpp::export]])
   - Keep all function signatures identical
   - Only improve documentation and formatting

4. Final verification:
   - All four C++ files should now follow the same standards
   - No mixed documentation styles (all Doxygen, no Roxygen for C++)
   - Consistent naming and formatting across all files
  </action>
  <verify>
- Check all four C++ files:
  - src/kf.cpp, src/rls_core.cpp, src/solve_fwd_bwd_cll.cpp, src/pf.cpp
  - Each has Doxygen documentation blocks
  - Each follows Google C++ Style Guide
  - No Roxygen comments (//') for function documentation
  - Consistent snake_case naming across files
- Quick compilation check: Run `Rcpp::compileAttributes()` and verify no errors
  </verify>
  <done>
- All C++ source files have consistent Doxygen documentation
- All C++ files follow Google C++ Style Guide formatting
- Documentation includes @param, @return, @brief for all functions
- No functional changes to any algorithms
- Code is more maintainable with clear API documentation
  </done>
</task>

</tasks>

<verification>
1. Run a quick package load test: `devtools::load_all()` should succeed without C++ compilation errors
2. Check that NAMESPACE still exports the same C++ functions (kf_cpp, rls_exp_cpp, etc.)
3. Verify documentation consistency by sampling a few functions from each file
</verification>

<success_criteria>
- [x] All C++ functions have Doxygen documentation with @param, @return, @brief tags
- [x] Code follows Google C++ Style Guide (2-space indentation, 80-char lines, snake_case)
- [x] No Roxygen comments (//') remain for C++ function documentation
- [x] Package loads without C++ compilation errors
- [x] Function signatures and algorithms unchanged (only documentation and formatting)
</success_criteria>

<output>
After completion, create `.planning/phases/02-code-organization/02-01-SUMMARY.md`
</output>