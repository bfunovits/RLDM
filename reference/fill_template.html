<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Connect Deep Parameters with a Model — fill_template • RLDM</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Connect Deep Parameters with a Model — fill_template"><meta name="description" content='fill_template fills a given template,
i.e. in essence an affine mapping from the free parameters to the linear parameters of a model class specified in the template,
with the given free (deep) parameters th and returns a model (e.g. an armamod() or a stspmod()).
The procedure can be used to generate random models, see e.g. r_model(), or for M-estimates,
i.e. for estimation procedures where the estimate is obtained by minimizing (maximizing) a criterion (e.g. ML or GMM estimation).

The "inverse function" extract_theta extracts the free/deep parameters from the linear parameters of a model,
by using the information provided in the template.
To this end the procedure first constructs the vector \(\pi\) of the stacked (linear) model parameters and then determines the deep parameters \(\theta\) as the least squares solution of the equation system
$$(\pi - h) =  H\theta$$
If the residuals are non zero, then the model does not (exactly) fit to the model structure.
The threshold tol is used to decide whether the model fits to the template or not.
The parameter on_error decides what to do in the case of a "significant" misfit.
For "ignore" the procedure ignores the misfit, for "warn" the procedure issues a warning,
and for "stop" the procedure stops with an appropriate error message.

In many cases the noise covariance is not explicitly parametrized, since \(\Sigma\) is estimated by another route.
This may be accomplished by fixing sigma_L to the identity matrix, with the option sigma_L = "identity" for the tmpl_*** functions.
In order to extract the system parameters (e.g. the AR and MA parameters for an ARMA model) from a model where sigma_L is not equal to the identity, one may use the option ignore_sigma_L = TRUE.
This ignores a possible mismatch for sigma_L but still checks whether the system parameters are in accordance to the model structure.'><meta property="og:description" content='fill_template fills a given template,
i.e. in essence an affine mapping from the free parameters to the linear parameters of a model class specified in the template,
with the given free (deep) parameters th and returns a model (e.g. an armamod() or a stspmod()).
The procedure can be used to generate random models, see e.g. r_model(), or for M-estimates,
i.e. for estimation procedures where the estimate is obtained by minimizing (maximizing) a criterion (e.g. ML or GMM estimation).

The "inverse function" extract_theta extracts the free/deep parameters from the linear parameters of a model,
by using the information provided in the template.
To this end the procedure first constructs the vector \(\pi\) of the stacked (linear) model parameters and then determines the deep parameters \(\theta\) as the least squares solution of the equation system
$$(\pi - h) =  H\theta$$
If the residuals are non zero, then the model does not (exactly) fit to the model structure.
The threshold tol is used to decide whether the model fits to the template or not.
The parameter on_error decides what to do in the case of a "significant" misfit.
For "ignore" the procedure ignores the misfit, for "warn" the procedure issues a warning,
and for "stop" the procedure stops with an appropriate error message.

In many cases the noise covariance is not explicitly parametrized, since \(\Sigma\) is estimated by another route.
This may be accomplished by fixing sigma_L to the identity matrix, with the option sigma_L = "identity" for the tmpl_*** functions.
In order to extract the system parameters (e.g. the AR and MA parameters for an ARMA model) from a model where sigma_L is not equal to the identity, one may use the option ignore_sigma_L = TRUE.
This ignores a possible mismatch for sigma_L but still checks whether the system parameters are in accordance to the model structure.'><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RLDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9006</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/0_getting_started.html">Getting Started with RLDM</a></li>
    <li><a class="dropdown-item" href="../articles/1_case_study.html">Case Study: Economic Data Analysis with RLDM</a></li>
    <li><a class="dropdown-item" href="../articles/2_technical_reference.html">Technical Reference: RLDM Classes and Methods</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bfunovits/RLDM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Connect Deep Parameters with a Model</h1>

      <div class="d-none name"><code>fill_template.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>fill_template</code> fills a given <code>template</code>,
i.e. in essence an affine mapping from the free parameters to the linear parameters of a model class specified in the template,
with the given free (deep) parameters <code>th</code> and returns a model (e.g. an <code><a href="armamod.html">armamod()</a></code> or a <code><a href="stspmod.html">stspmod()</a></code>).
The procedure can be used to generate random models, see e.g. <code><a href="r_model.html">r_model()</a></code>, or for <em>M-estimates</em>,
i.e. for estimation procedures where the estimate is obtained by minimizing (maximizing) a criterion (e.g. ML or GMM estimation).
<br><br>
The "inverse function" <code>extract_theta</code> extracts the free/deep parameters from the linear parameters of a model,
by using the information provided in the template.
To this end the procedure first constructs the vector \(\pi\) of the stacked (linear) model parameters and then determines the deep parameters \(\theta\) as the least squares solution of the equation system
$$(\pi - h) =  H\theta$$
If the residuals are non zero, then the model does not (exactly) fit to the model structure.
The threshold <code>tol</code> is used to decide whether the model fits to the template or not.
The parameter <code>on_error</code> decides what to do in the case of a "significant" misfit.
For <code>"ignore"</code> the procedure ignores the misfit, for <code>"warn"</code> the procedure issues a warning,
and for <code>"stop"</code> the procedure stops with an appropriate error message.
<br>
In many cases the noise covariance is not explicitly parametrized, since \(\Sigma\) is estimated by another route.
This may be accomplished by fixing sigma_L to the identity matrix, with the option <code>sigma_L = "identity"</code> for the <code>tmpl_***</code> functions.
In order to <strong>extract the system parameters</strong> (e.g. the AR and MA parameters for an ARMA model) from a model where <code>sigma_L</code> is not equal to the identity, one may use the option <code>ignore_sigma_L = TRUE</code>.
This ignores a possible mismatch for <code>sigma_L</code> but still checks whether the system parameters are in accordance to the model structure.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fill_template</span><span class="op">(</span><span class="va">th</span>, <span class="va">template</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">extract_theta</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  <span class="va">template</span>,</span>
<span>  tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span>,</span>
<span>  on_error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ignore"</span>, <span class="st">"warn"</span>, <span class="st">"stop"</span><span class="op">)</span>,</span>
<span>  ignore_sigma_L <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-th">th<a class="anchor" aria-label="anchor" href="#arg-th"></a></dt>
<dd><p>Vector containing free (deep) parameters.</p></dd>


<dt id="arg-template">template<a class="anchor" aria-label="anchor" href="#arg-template"></a></dt>
<dd><p>A template like listed in <code><a href="model_structures.html">model structures()</a></code>, or a template explicitly specified by the user with <code><a href="model_structures.html">model2template()</a></code>. Essentially, a template is an affine mapping parametrised as a vector <code>h</code> and matrix <code>H</code> which connect the free (deep) parameters to the linear parameters of the model.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>A model object, i.e. an <code><a href="armamod.html">armamod()</a></code>, <code><a href="stspmod.html">stspmod()</a></code>, or <code><a href="rmfdmod.html">rmfdmod()</a></code> object, from which deep parameters should be extracted.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>In <code>extract_theta</code>, small double specifying the tolerance for an acceptable distance between the linear parameters and <code>H</code> times the deep parameters.
Default is st to <code>sqrt(.Machine$double.eps)</code>.</p></dd>


<dt id="arg-on-error">on_error<a class="anchor" aria-label="anchor" href="#arg-on-error"></a></dt>
<dd><p>In <code>extract_theta</code>, character string with possible choices <code>ignore</code>, <code>warn</code>, <code>stop</code>.
Specifies what should happen when the distance between the linear parmameters and <code>H</code> times the deep parameters, is larger than the specified <code>tol</code>.
Default is <code>ignore</code></p></dd>


<dt id="arg-ignore-sigma-l">ignore_sigma_L<a class="anchor" aria-label="anchor" href="#arg-ignore-sigma-l"></a></dt>
<dd><p>Boolean, default set to <code>FALSE</code>.
If TRUE, the linear and free parameters pertaining
the left square root <code>sigma_L</code> of the error covariance matrix are ignored.
See also <code><a href="tmpl_sigma_L.html">tmpl_sigma_L()</a></code> and <code><a href="model_structures.html">model structures()</a></code> for more detail.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>fill_template</code> returns a model object, i.e. an <code><a href="armamod.html">armamod()</a></code>, <code><a href="stspmod.html">stspmod()</a></code>, or
<code><a href="rmfdmod.html">rmfdmod()</a></code> object, according to the class of the template (and the given parameters <code>th</code>).
The function <code>extract_theta</code> returns the vector of <em>free</em> parameters for a given model and template.</p>
    </div>
    <div class="section level2">
    <h2 id="connection-to-likelihood-estimation">Connection to Likelihood Estimation<a class="anchor" aria-label="anchor" href="#connection-to-likelihood-estimation"></a></h2>



<p>These functions are important for likelihood estimation where the following instances of functionality are necessary.</p><ul><li><p>When an initial estimate is given through a model (together with a template), one may use <code>extract_theta</code> to extract the deep parameters. This vector of initial free/deep parameter values needs to be supplied to an optimizer.</p></li>
<li><p>The optimized deep parameter values need to be filled into the model by using the structure provided by a template. This is done with <code>fill_template</code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="model_structures.html">model structures()</a></code>, <code><a href="ll.html">ll()</a></code>, <code><a href="ll_theta.html">ll_theta()</a></code> and <code><a href="ll_FUN.html">ll_FUN()</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Extract deep parameter from ARMA object with ARMA(p,q) template ##########</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">armamod_obj</span> <span class="op">=</span> <span class="fu"><a href="test_armamod.html">test_armamod</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ARMA model [2,2] with orders p = 3 and q = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AR polynomial a(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]   z^1 [,1]       [,2]  z^2 [,1]      [,2]   z^3 [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0  0.4609162 -0.6868529 1.2240818 0.4007715 -0.5558411</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1 -1.2650612 -0.4456620 0.3598138 0.1106827  1.7869131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.4978505</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -1.9666172</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MA polynomial b(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]   z^1 [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0  0.7013559 -1.0678237</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1 -0.4727914 -0.2179749</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Left square root of noise covariance Sigma:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          u[1]     u[2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[1] 1.564061 0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[2] 0.212037 1.703367</span>
<span class="r-in"><span><span class="op">(</span><span class="va">tmpl_obj</span> <span class="op">=</span> <span class="fu"><a href="model_structures.html">tmpl_arma_pq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $h</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 0 0 0 0 0 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $H</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    1    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]    0    1    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]    0    0    1    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]    0    0    0    1    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]    0    0    0    0    1    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]    0    0    0    0    0    1    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]    0    0    0    0    0    0    1    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]    0    0    0    0    0    0    0    1    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]    0    0    0    0    0    0    0    0    1     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]    0    0    0    0    0    0    0    0    0     1     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]    0    0    0    0    0    0    0    0    0     0     1     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]    0    0    0    0    0    0    0    0    0     0     0     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,]    0    0    0    0    0    0    0    0    0     0     0     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,14] [,15] [,16] [,17] [,18] [,19]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,]     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,]     1     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,]     0     1     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,]     0     0     1     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,]     0     0     0     1     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,]     0     0     0     0     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,]     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,]     0     0     0     0     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "armamod"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $order</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 2 3 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.par</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">extract_theta</span><span class="op">(</span><span class="va">armamod_obj</span>, <span class="va">tmpl_obj</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  0.4609162 -1.2650612 -0.6868529 -0.4456620  1.2240818  0.3598138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7]  0.4007715  0.1106827 -0.5558411  1.7869131  0.4978505 -1.9666172</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13]  0.7013559 -0.4727914 -1.0678237 -0.2179749  1.5640610  0.2120370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19]  1.7033671</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fill template with deep parameters #################</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">tmpl_obj</span> <span class="op">=</span> <span class="fu"><a href="model_structures.html">tmpl_arma_echelon</a></span><span class="op">(</span>nu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $h</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $H</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]    1    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    0    1    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]    0    0    1    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]    0    0    0    1    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]    0    0    0    0    1    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]    0    0    0    0    0    1    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]    0    0    0    0    0    0    1    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]    0    0    0    0    0    0    0    1    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]    0    0    0    0    0    0    0    0    1     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]    0    0    0    0    0    0    0    0    0     1     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]    1    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,]    0    0    0    0    0    0    0    0    0     0     1     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,]    0    0    0    0    0    0    0    0    0     0     0     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,]    0    0    0    0    0    0    0    0    0     0     0     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [32,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [33,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [34,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [35,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [36,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,]     1     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,]     0     1     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,]     0     0     1     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,]     0     0     0     1     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,]     0     0     0     0     1     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29,]     0     0     0     0     0     1     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31,]     0     0     0     0     0     0     1     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [32,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [33,]     0     0     0     0     0     0     0     1     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [34,]     0     0     0     0     0     0     0     0     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [35,]     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [36,]     0     0     0     0     0     0     0     0     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "armamod"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $order</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 2 3 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.par</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $nu</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Number of columns of matrix H in affine mapping = number of free parameters</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">n_par_deep</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">tmpl_obj</span><span class="op">$</span><span class="va">H</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 23</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">fill_template</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_par_deep</span><span class="op">)</span>, <span class="va">tmpl_obj</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ARMA model [2,2] with orders p = 3 and q = 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AR polynomial a(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       z^0 [,1]  [,2]   z^1 [,1]      [,2]  z^2 [,1]      [,2]  z^3 [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.000000     0 -0.7288912  0.000000 0.8377870 -1.138137 0.4264642</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -1.026004     1 -0.6250393 -1.686693 0.1533731  1.253815 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.2950715</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MA polynomial b(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       z^0 [,1]  [,2]  z^1 [,1]      [,2]    z^2 [,1]       [,2]  z^3 [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.000000     0 0.8951257 0.8215811  0.55391765 -0.3059627 -0.694707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -1.026004     1 0.8781335 0.6886403 -0.06191171 -0.3804710  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.2079173</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Left square root of noise covariance Sigma:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           u[1]     u[2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[1] -1.265396 0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[2]  2.168956 1.207962</span>
<span class="r-in"><span><span class="co"># Basic example</span></span></span>
<span class="r-in"><span><span class="co"># Create a template</span></span></span>
<span class="r-in"><span><span class="va">tmpl</span> <span class="op">&lt;-</span> <span class="fu"><a href="model_structures.html">tmpl_stsp_ar</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fl">2</span>, p <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Generate a random model with this structure</span></span></span>
<span class="r-in"><span><span class="va">th0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">tmpl</span><span class="op">$</span><span class="va">n.par</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">fill_template</span><span class="op">(</span><span class="va">th0</span>, <span class="va">tmpl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Extract the "free" parameters from the model</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">extract_theta</span><span class="op">(</span><span class="va">model</span>, <span class="va">tmpl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.112310858 -0.040288484 -0.046665535  0.077996512 -0.008336907</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6]  0.025331851 -0.002854676</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://scholar.google.com/citations?user=-Ytb9BYAAAAJ" class="external-link">Wolfgang Scherrer</a>, <a href="https://ch.linkedin.com/in/bernd-funovits-phd-cfa-a8215016" class="external-link">Bernd Funovits</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

