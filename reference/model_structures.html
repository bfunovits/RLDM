<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Model Structures — model structures • RLDM</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model Structures — model structures"><meta name="description" content="These tools define and implement model structures where the model parameters are represented
by an affine function of some free (deep) parameters. As an example consider
multivariate ARMA models. The AR coefficients \(a_k\), the MA coefficients \(b_k\)
and the (left) square root of the noise covariance matrix, \(L\) say, are vectorized and stacked
into a (long) parameter vector as
$$\pi = (\mbox{vec}(a_1)',\ldots,\mbox{vec}(a_p)',
             \mbox{vec}(b_1)',\ldots,\mbox{vec}(b_q)',\mbox{vec}(L)')'$$
This parameter vector then is written as
$$\pi = h + H\theta$$
where \(\theta\) represents the free parameters. Of course the matrix \(H\) is assumed to have
full column rank. This parameterization scheme is quite flexible. In particular, ARMA and
state space models in echelon form may be represented by this scheme.

Templates and the related tools are mainly used for estimation and for the generation of (random) models
for simulations and testing."><meta property="og:description" content="These tools define and implement model structures where the model parameters are represented
by an affine function of some free (deep) parameters. As an example consider
multivariate ARMA models. The AR coefficients \(a_k\), the MA coefficients \(b_k\)
and the (left) square root of the noise covariance matrix, \(L\) say, are vectorized and stacked
into a (long) parameter vector as
$$\pi = (\mbox{vec}(a_1)',\ldots,\mbox{vec}(a_p)',
             \mbox{vec}(b_1)',\ldots,\mbox{vec}(b_q)',\mbox{vec}(L)')'$$
This parameter vector then is written as
$$\pi = h + H\theta$$
where \(\theta\) represents the free parameters. Of course the matrix \(H\) is assumed to have
full column rank. This parameterization scheme is quite flexible. In particular, ARMA and
state space models in echelon form may be represented by this scheme.

Templates and the related tools are mainly used for estimation and for the generation of (random) models
for simulations and testing."><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RLDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9006</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/0_getting_started.html">Getting Started with RLDM</a></li>
    <li><a class="dropdown-item" href="../articles/1_case_study.html">Case Study: Economic Data Analysis with RLDM</a></li>
    <li><a class="dropdown-item" href="../articles/2_technical_reference.html">Technical Reference: RLDM Classes and Methods</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bfunovits/RLDM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Model Structures</h1>

      <div class="d-none name"><code>model_structures.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These tools define and implement <strong>model structures</strong> where the <strong>model parameters</strong> are represented
by an affine function of some <strong>free</strong> (<strong>deep</strong>) parameters. As an example consider
multivariate ARMA models. The AR coefficients \(a_k\), the MA coefficients \(b_k\)
and the (left) square root of the noise covariance matrix, \(L\) say, are vectorized and stacked
into a (long) parameter vector as
$$\pi = (\mbox{vec}(a_1)',\ldots,\mbox{vec}(a_p)',
             \mbox{vec}(b_1)',\ldots,\mbox{vec}(b_q)',\mbox{vec}(L)')'$$
This parameter vector then is written as
$$\pi = h + H\theta$$
where \(\theta\) represents the <strong>free</strong> parameters. Of course the matrix \(H\) is assumed to have
full column rank. This parameterization scheme is quite flexible. In particular, ARMA and
state space models in <strong>echelon form</strong> may be represented by this scheme.
<br>
Templates and the related tools are mainly used for estimation and for the generation of (random) models
for simulations and testing.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">model2template</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  sigma_L <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"as_given"</span>, <span class="st">"chol"</span>, <span class="st">"symm"</span>, <span class="st">"identity"</span>, <span class="st">"full_normalized"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tmpl_arma_pq</span><span class="op">(</span></span>
<span>  <span class="va">m</span>,</span>
<span>  <span class="va">n</span>,</span>
<span>  <span class="va">p</span>,</span>
<span>  <span class="va">q</span>,</span>
<span>  sigma_L <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chol"</span>, <span class="st">"symm"</span>, <span class="st">"identity"</span>, <span class="st">"full_normalized"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tmpl_arma_echelon</span><span class="op">(</span></span>
<span>  <span class="va">nu</span>,</span>
<span>  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">nu</span><span class="op">)</span>,</span>
<span>  sigma_L <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chol"</span>, <span class="st">"symm"</span>, <span class="st">"identity"</span>, <span class="st">"full_normalized"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tmpl_rmfd_pq</span><span class="op">(</span></span>
<span>  <span class="va">m</span>,</span>
<span>  <span class="va">n</span>,</span>
<span>  <span class="va">p</span>,</span>
<span>  <span class="va">q</span>,</span>
<span>  sigma_L <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chol"</span>, <span class="st">"symm"</span>, <span class="st">"identity"</span>, <span class="st">"full_normalized"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tmpl_rmfd_echelon</span><span class="op">(</span></span>
<span>  <span class="va">nu</span>,</span>
<span>  m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">nu</span><span class="op">)</span>,</span>
<span>  sigma_L <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chol"</span>, <span class="st">"symm"</span>, <span class="st">"identity"</span>, <span class="st">"full_normalized"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tmpl_stsp_full</span><span class="op">(</span></span>
<span>  <span class="va">m</span>,</span>
<span>  <span class="va">n</span>,</span>
<span>  <span class="va">s</span>,</span>
<span>  sigma_L <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chol"</span>, <span class="st">"symm"</span>, <span class="st">"identity"</span>, <span class="st">"full_normalized"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tmpl_stsp_ar</span><span class="op">(</span><span class="va">m</span>, <span class="va">p</span>, sigma_L <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chol"</span>, <span class="st">"symm"</span>, <span class="st">"identity"</span>, <span class="st">"full_normalized"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tmpl_stsp_echelon</span><span class="op">(</span></span>
<span>  <span class="va">nu</span>,</span>
<span>  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">nu</span><span class="op">)</span>,</span>
<span>  sigma_L <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chol"</span>, <span class="st">"symm"</span>, <span class="st">"identity"</span>, <span class="st">"full_normalized"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p><code><a href="armamod.html">armamod()</a></code>, <code><a href="rmfdmod.html">rmfdmod()</a></code> or <code><a href="stspmod.html">stspmod()</a></code> object.</p></dd>


<dt id="arg-sigma-l">sigma_L<a class="anchor" aria-label="anchor" href="#arg-sigma-l"></a></dt>
<dd><p>(character string) determines the form of the (left) square root
of the noise covariance \(\Sigma\). The choice <code>"chol"</code> gives a
lower triangular matrix, <code>"symm"</code> gives a symmetric matrix and
<code>"identity"</code> corresponds to a fixed (identity) matrix.
The  procedure <code>model2template</code> has an additional option <code>"as_given"</code>
which means that the structure of the square root <code>sigma_L</code> is
completely determined by the <code>sigma_L</code> slot of the given model.</p></dd>


<dt id="arg-m">m<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>output dimension</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>input dimension (= number of shocks = dimension of the noise process)</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>order of the AR polynomial for ARMA models, respectively the order of the
right factor polynomial \(c(z)\) in an RMFD model.</p></dd>


<dt id="arg-q">q<a class="anchor" aria-label="anchor" href="#arg-q"></a></dt>
<dd><p>order of the MA polynomial for ARMA models, respectively the order of the
left factor polynomial \(d(z)\) in an RMFD model.</p></dd>


<dt id="arg-nu">nu<a class="anchor" aria-label="anchor" href="#arg-nu"></a></dt>
<dd><p>vector of Kronecker indices. For ARMA models the Kronecker indices
describe the basis rows and for RMFD models the basis columns
of the Hankel matrix of the impulse response coefficients.</p></dd>


<dt id="arg-s">s<a class="anchor" aria-label="anchor" href="#arg-s"></a></dt>
<dd><p>state dimension for state space models.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The functions <code>model2template</code> and <code>tmpl_***</code> return a model template.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The functions <code>model2template</code> and <code>tmpl_***</code> generate model "templates" which
represent certain model structures, where the model parameters are affine functions of some
<strong>free</strong>, respectively <strong>deep</strong>, parameters.</p>
<p>The template contains information about the model structure in the following slots</p><ol><li><p><code>h, H</code> represent the vector \(h\) and the marix \(H\) as described above.
(The vector \(\pi\) of stacked model parameters is represented as
\(\pi = h +H \theta\) where \(\theta\) is a vector of <em>deep</em> parameters.)</p></li>
<li><p><code>class=["armamod"|"rmfdmod"|"stspmod"]</code>: determines whether the template parametrizes
ARMA, RMFD or state space models.</p></li>
<li><p><code>order</code>: an integer vector which contains the dimensions and orders of the model.
For ARMA and RMFD models <code>order = c(m,n,p,q)</code> and
for state space models <code>order = c(m,n,s)</code>.</p></li>
<li><p><code>n.par</code>: the number of <em>free</em> parameters, i.e. the dimension of the
vector \(\theta\).</p></li>
<li><p><code>nu</code>: This optional slot contains the Kronecker indices \(\nu\).</p></li>
</ol><p><strong>model2template:</strong></p>
<p>The function <code>model2template()</code> takes an <code><a href="armamod.html">armamod()</a></code>, <code><a href="rmfdmod.html">rmfdmod()</a></code>, or <code><a href="stspmod.html">stspmod()</a></code> object
where the free parameters are coded as <code>NA</code>'s, <code>NaN</code>'s or <code>Inf</code>'s and
constructs a corresponding model template.</p>
<p>For the parametrization of the (left) square root, \(L\) say, of the noise covariance \(\Sigma = LL'\)
the following choices are possible: In the case <code>sigma_L = "as_given"</code> the
slot <code>model$sigma_L</code> of the given <code>model</code> is used to construct the template: <code>NA</code> entries
are considered as free and all other entries as fixed. For the choice <code>sigma_L = "chol"</code>
first all entries of <code>model$sigma_L</code> above the diagonal are set to zero and then
the template is constructed as above. In the case <code>sigma_L = "symm"</code>
the matrix  <code>model$sigma_L</code> is first replaced by a symmetric one and then the template
is constructed (according to the <code>NA</code>'s) such that the square root <code>L=sigma_L</code> is always
symmetric. The choice <code>sigma_L = "identity"</code> sets the matrix <code>L = sigma_L</code> to the
identity matrix.
Finally, the choice <code>sigma_L = "full_normalized"</code> sets the diagonal elements equal to ones and all other elements to NAs in <code>L = sigma_L</code>.</p>
<p><strong>tmpl_</strong><em>:</em>*</p>
<p>The functions <code>tmpl_***</code> implement the following model structures:</p><dl><dt>tmpl_arma_pq</dt>
<dd><p>ARMA models (<code><a href="armamod.html">armamod()</a></code>) with prescribed orders \((p,q\)).</p></dd>

<dt>tmpl_arma_echelon</dt>
<dd><p>ARMA models (<code><a href="armamod.html">armamod()</a></code>) in echelon form, with given
Kronecker indices \(\nu\).</p></dd>

<dt>tmpl_rmfd_pq</dt>
<dd><p>RMFD models (<code><a href="rmfdmod.html">rmfdmod()</a></code>) with prescribed orders \((p,q\)).</p></dd>

<dt>tmpl_rmfd_echelon</dt>
<dd><p>RMFD models (<code><a href="rmfdmod.html">rmfdmod()</a></code>) in echelon form, with
Kronecker indices \(\nu\). Note that for RMFD models the
Kronecker indices refer to the basis of the <em>column space</em>
of the Hankel matrix of the impulse response coefficients.</p></dd>

<dt>tmpl_stsp_full</dt>
<dd><p>Fully parametrized state space models (<code><a href="stspmod.html">stspmod()</a></code>)
with given state space dimension \(s\),
i.e. a models where each entry in the matrices \(A,B,C\)
is considered non-fixed.</p></dd>

<dt>tmpl_stsp_echelon</dt>
<dd><p>State space models (<code><a href="stspmod.html">stspmod()</a></code>) in echelon form,
with given Kronecker indices \(\nu\).</p></dd>

<dt>tmpl_state space_ar</dt>
<dd><p>State space model representations (<code><a href="stspmod.html">stspmod()</a></code>)
of AR models with given order \(p\).
Here only the "square" case \(m=n\) is implemented.</p></dd>


</dl><p>For these model structures the impulse response (transfer function) is scaled such that the
\((m,n)\)-dimensional lag zero coefficient, \(k_0\) say, is of the form</p><dl><dt>\(m=n\)</dt>
<dd><p>\(k_0\) is the \(m\)-dimensional identity matrix.</p></dd>

<dt>\(m&lt;n\)</dt>
<dd><p>The first \(m\) columns of \(k_0\) form the
\(m\)-dimensional identity matrix and the remaining columns are zero.</p></dd>

<dt>\(m&gt;n\)</dt>
<dd><p>The first \(n\) rows of \(k_0\) form the
\(n\)-dimensional identity matrix and the remaining rows are <em>free</em>.</p></dd>


</dl><p>For the parametrization of the (left) square root \(L\) of the noise covariance \(\Sigma = LL'\)
the following choices are possible: For <code>sigma_L="chol"</code> the matrix \(L\) is lower triangular
(all entries on and below the main diagonal are considered as free and the entries above the diagonal are zero).
For <code>sigma_L="symm"</code> the matrix \(L\) is symmetric (all entries on and below the main diagonal are considered
as free and the entries above the diagonal are such that \(L=L'\) holds).
For <code>sigma_L="identity"</code> the matrix \(L\) is <em>fixed</em> to the \(n\)-dimensional identity matrix.
For <code>sigma_L="full_normalized"</code> the diagonal elements of the matrix \(L\) are <em>fixed</em> to ones and all other elements are free.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="r_model.html">r_model()</a></code>, <code><a href="fill_template.html">fill_template()</a></code>, <code><a href="ll.html">ll()</a></code>, <code><a href="ll_theta.html">ll_theta()</a></code> and other estimation procedures</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ######################################################</span></span></span>
<span class="r-in"><span><span class="co"># construct a template from a model</span></span></span>
<span class="r-in"><span><span class="co"># ######################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Let us consider scalar ARMA(5,1) models</span></span></span>
<span class="r-in"><span><span class="co"># for quarterly data with a strong seasonal component.</span></span></span>
<span class="r-in"><span><span class="co"># In order to have parsimonious models we want a[2]=a[3]=0:</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="armamod.html">armamod</a></span><span class="op">(</span><span class="fu"><a href="https://bfunovits.github.io/rationalmatrices/reference/lmfd.html" class="external-link">lmfd</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="cn">NA</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="cn">NA</span>,<span class="cn">NA</span><span class="op">)</span>, b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="cn">NA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tmpl</span> <span class="op">=</span> <span class="fu">model2template</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Let's see how the "free" parameters are mapped to the model parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">tmpl</span><span class="op">$</span><span class="va">h</span>, <span class="va">tmpl</span><span class="op">$</span><span class="va">H</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1] [,2] [,3] [,4] [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    1    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]    0    1    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    0    0    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]    0    0    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]    1    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]    0    0    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]    1    0    0    0    0</span>
<span class="r-in"><span><span class="va">th</span> <span class="op">=</span> <span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">tmpl</span><span class="op">$</span><span class="va">n.par</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="fill_template.html">fill_template</a></span><span class="op">(</span><span class="va">th</span>, <span class="va">tmpl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ARMA model [1,1] with orders p = 5 and q = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AR polynomial a(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1] z^1 [,1] z^2 [,1] z^3 [,1] z^4 [,1] z^5 [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1       -1        0        0       -2       -3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MA polynomial b(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1] z^1 [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1       -4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Left square root of noise covariance Sigma:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      u[1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[1]    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate a random model with this structure</span></span></span>
<span class="r-in"><span><span class="va">th0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">tmpl</span><span class="op">$</span><span class="va">n.par</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="fill_template.html">fill_template</a></span><span class="op">(</span><span class="va">th0</span>, <span class="va">tmpl</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract the "free" parameters from the model</span></span></span>
<span class="r-in"><span><span class="va">th</span> <span class="op">=</span> <span class="fu"><a href="fill_template.html">extract_theta</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">tmpl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">th</span>, <span class="va">th0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This model structure fixes sigma_L = 1.</span></span></span>
<span class="r-in"><span><span class="co"># If we change sigma_L = 2 then the model does not fit to the template.</span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="va">sigma_L</span> <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="co"># the default choice on_error = 'ignore', tells</span></span></span>
<span class="r-in"><span><span class="co"># extract_theta to ignore this misfit:</span></span></span>
<span class="r-in"><span><span class="va">th</span> <span class="op">=</span> <span class="fu"><a href="fill_template.html">extract_theta</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">tmpl</span>, on_error <span class="op">=</span> <span class="st">'ignore'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># with on_error = 'warn' we get a warning and</span></span></span>
<span class="r-in"><span><span class="co"># with on_error = 'stop' would throw an error.</span></span></span>
<span class="r-in"><span><span class="va">th</span> <span class="op">=</span> <span class="fu"><a href="fill_template.html">extract_theta</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">tmpl</span>, on_error <span class="op">=</span> <span class="st">'warn'</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>model does not match template. max(abs(res)) = 1</span>
<span class="r-in"><span><span class="co"># We may also "ignore" sigma_L</span></span></span>
<span class="r-in"><span><span class="va">th</span> <span class="op">=</span> <span class="fu"><a href="fill_template.html">extract_theta</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">tmpl</span>, on_error <span class="op">=</span> <span class="st">'stop'</span>, ignore_sigma_L<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If the orders/class of template and model does not fit</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="armamod.html">armamod</a></span><span class="op">(</span><span class="fu"><a href="https://bfunovits.github.io/rationalmatrices/reference/lmfd.html" class="external-link">lmfd</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="fill_template.html">extract_theta</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">tmpl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="stspmod.html">stspmod</a></span><span class="op">(</span><span class="fu"><a href="https://bfunovits.github.io/rationalmatrices/reference/stsp.html" class="external-link">stsp</a></span><span class="op">(</span>D <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="fill_template.html">extract_theta</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">tmpl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ######################################################</span></span></span>
<span class="r-in"><span><span class="co"># the parameter "sigma_L"</span></span></span>
<span class="r-in"><span><span class="co"># ######################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># consider a state space model (with 1 state) for a 3-dimensional process</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="stspmod.html">stspmod</a></span><span class="op">(</span><span class="fu"><a href="https://bfunovits.github.io/rationalmatrices/reference/stsp.html" class="external-link">stsp</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">1</span>, B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, D <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We may specify an arbitrary structure for the left square root (L = sigma_L)</span></span></span>
<span class="r-in"><span><span class="co"># of the noise covariance Sigma. Any NA entry is considered as a "free" parameter.</span></span></span>
<span class="r-in"><span><span class="va">L</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">L</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   NA    2    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    1    3    1</span>
<span class="r-in"><span><span class="co"># L has 2 NA entries and thus we get a model structure with 2 free parameters.</span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="va">sigma_L</span> <span class="op">=</span> <span class="va">L</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tmpl</span> <span class="op">=</span> <span class="fu">model2template</span><span class="op">(</span><span class="va">model</span>, sigma_L <span class="op">=</span> <span class="st">'as_given'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">th</span> <span class="op">=</span> <span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">tmpl</span><span class="op">$</span><span class="va">n.par</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="fill_template.html">fill_template</a></span><span class="op">(</span><span class="va">th</span>, <span class="va">tmpl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> state space model [3,3] with s = 1 states</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      s[1] u[1] u[2] u[3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[1]    1    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[1]    1    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[2]    1    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[3]    1    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Left square root of noise covariance Sigma:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      u[1] u[2] u[3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[1]    0    0   -2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[2]   -1    2    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[3]    1    3    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The choice sigma_L = 'chol' forces L to be lower triangular.</span></span></span>
<span class="r-in"><span><span class="co"># In the case considered here, we get a model structure with 1 free parameter.</span></span></span>
<span class="r-in"><span><span class="va">tmpl</span> <span class="op">=</span> <span class="fu">model2template</span><span class="op">(</span><span class="va">model</span>, sigma_L <span class="op">=</span> <span class="st">'chol'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">th</span> <span class="op">=</span> <span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">tmpl</span><span class="op">$</span><span class="va">n.par</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="fill_template.html">fill_template</a></span><span class="op">(</span><span class="va">th</span>, <span class="va">tmpl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> state space model [3,3] with s = 1 states</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      s[1] u[1] u[2] u[3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[1]    1    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[1]    1    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[2]    1    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[3]    1    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Left square root of noise covariance Sigma:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      u[1] u[2] u[3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[1]    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[2]   -1    2    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[3]    1    3    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The choice sigma_L = 'symm' forces L = sigma_L to be symmetric.</span></span></span>
<span class="r-in"><span><span class="co"># In the case considered here we thus get a model structure with 2 free parameters.</span></span></span>
<span class="r-in"><span><span class="va">tmpl</span> <span class="op">=</span> <span class="fu">model2template</span><span class="op">(</span><span class="va">model</span>, sigma_L <span class="op">=</span> <span class="st">'symm'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">th</span> <span class="op">=</span> <span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">tmpl</span><span class="op">$</span><span class="va">n.par</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="fill_template.html">fill_template</a></span><span class="op">(</span><span class="va">th</span>, <span class="va">tmpl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> state space model [3,3] with s = 1 states</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      s[1] u[1] u[2] u[3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[1]    1    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[1]    1    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[2]    1    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[3]    1    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Left square root of noise covariance Sigma:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      u[1] u[2] u[3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[1]    0   -1   -2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[2]   -1    2    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[3]   -2    2    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The choice sigma_L = 'identity' set L equal to the identity matrix,</span></span></span>
<span class="r-in"><span><span class="co"># i.e. sigma_L is fixed.</span></span></span>
<span class="r-in"><span><span class="va">tmpl</span> <span class="op">=</span> <span class="fu">model2template</span><span class="op">(</span><span class="va">model</span>, sigma_L <span class="op">=</span> <span class="st">'identity'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">th</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="fill_template.html">fill_template</a></span><span class="op">(</span><span class="va">th</span>, <span class="va">tmpl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> state space model [3,3] with s = 1 states</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      s[1] u[1] u[2] u[3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[1]    1    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[1]    1    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[2]    1    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[3]    1    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Left square root of noise covariance Sigma:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      u[1] u[2] u[3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[1]    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[2]    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[3]    0    0    1</span>
<span class="r-in"><span><span class="va">tmpl</span><span class="op">$</span><span class="va">n.par</span> <span class="co"># there are no free parameters: tmpl$n.par = 0</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The choice sigma_L = 'full_normalized' sets the diagonal elements of L equal to ones,</span></span></span>
<span class="r-in"><span><span class="co"># and leaves all other elements free.</span></span></span>
<span class="r-in"><span><span class="va">tmpl</span> <span class="op">=</span> <span class="fu">model2template</span><span class="op">(</span><span class="va">model</span>, sigma_L <span class="op">=</span> <span class="st">'full_normalized'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">th</span> <span class="op">=</span> <span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">tmpl</span><span class="op">$</span><span class="va">n.par</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="fill_template.html">fill_template</a></span><span class="op">(</span><span class="va">th</span>, <span class="va">tmpl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> state space model [3,3] with s = 1 states</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      s[1] u[1] u[2] u[3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[1]    1    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[1]    1    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[2]    1    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[3]    1    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Left square root of noise covariance Sigma:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      u[1] u[2] u[3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[1]    1   -3   -5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[2]   -1    1   -6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[3]   -2   -4    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ######################################################</span></span></span>
<span class="r-in"><span><span class="co"># ARMA(p,q) models</span></span></span>
<span class="r-in"><span><span class="co"># ######################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">=</span> <span class="fl">2</span> <span class="co"># output dimension</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">=</span> <span class="fl">1</span> <span class="co"># AR order</span></span></span>
<span class="r-in"><span><span class="va">q</span> <span class="op">=</span> <span class="fl">1</span> <span class="co"># MA order</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># model structure with lower triangular sigma_L</span></span></span>
<span class="r-in"><span><span class="va">tmpl</span> <span class="op">=</span> <span class="fu">tmpl_arma_pq</span><span class="op">(</span><span class="va">m</span>, n <span class="op">=</span> <span class="va">m</span>, <span class="va">p</span>, <span class="va">q</span>, sigma_L <span class="op">=</span> <span class="st">"chol"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">th</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">tmpl</span><span class="op">$</span><span class="va">n.par</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">th</span> <span class="op">=</span> <span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">tmpl</span><span class="op">$</span><span class="va">n.par</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="fill_template.html">fill_template</a></span><span class="op">(</span><span class="va">th</span>, <span class="va">tmpl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ARMA model [2,2] with orders p = 1 and q = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AR polynomial a(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0       -1    -3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1       -2    -4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MA polynomial b(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0       -5    -7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1       -6    -8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Left square root of noise covariance Sigma:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      u[1] u[2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[1]   -9    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[2]  -10  -11</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># model structure with symmetric sigma_L</span></span></span>
<span class="r-in"><span><span class="va">tmpl</span> <span class="op">=</span> <span class="fu">tmpl_arma_pq</span><span class="op">(</span><span class="va">m</span>, n <span class="op">=</span> <span class="va">m</span>, <span class="va">p</span>, <span class="va">q</span>, sigma_L <span class="op">=</span> <span class="st">"symm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="fill_template.html">fill_template</a></span><span class="op">(</span><span class="va">th</span>, <span class="va">tmpl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ARMA model [2,2] with orders p = 1 and q = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AR polynomial a(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0       -1    -3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1       -2    -4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MA polynomial b(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0       -5    -7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1       -6    -8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Left square root of noise covariance Sigma:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      u[1] u[2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[1]   -9  -10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[2]  -10  -11</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># model structure with sigma_L = I</span></span></span>
<span class="r-in"><span><span class="va">tmpl</span> <span class="op">=</span> <span class="fu">tmpl_arma_pq</span><span class="op">(</span><span class="va">m</span>, n <span class="op">=</span> <span class="va">m</span>, <span class="va">p</span>, <span class="va">q</span>, sigma_L <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># here the number of free paramaters is of course (by 3) smaller</span></span></span>
<span class="r-in"><span><span class="co"># than for the above model structures!</span></span></span>
<span class="r-in"><span><span class="fu"><a href="fill_template.html">fill_template</a></span><span class="op">(</span><span class="va">th</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">th</span><span class="op">)</span><span class="op">-</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span>, <span class="va">tmpl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ARMA model [2,2] with orders p = 1 and q = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AR polynomial a(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0       -1    -3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1       -2    -4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MA polynomial b(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0       -5    -7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1       -6    -8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Left square root of noise covariance Sigma:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      u[1] u[2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[1]    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[2]    0    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a template</span></span></span>
<span class="r-in"><span><span class="va">tmpl</span> <span class="op">&lt;-</span> <span class="fu">tmpl_arma_echelon</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in tmpl_arma_echelon():</span> argument "nu" is missing, with no default</span>
<span class="r-in"><span><span class="va">tmpl</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $h</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $H</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    1    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]    0    1    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]    0    0    1    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]    0    0    0    1    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]    0    0    0    0    1    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]    0    0    0    0    0    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]    0    0    0    0    0    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]    0    0    0    0    0    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "armamod"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $order</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 2 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.par</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use the template with fill_template()</span></span></span>
<span class="r-in"><span><span class="co"># filled &lt;- fill_template(tmpl, theta = rnorm(tmpl$n.par))</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ######################################################</span></span></span>
<span class="r-in"><span><span class="co"># RMFD(p,q) models y[t] = d(z) c(z)^-1 e[t]</span></span></span>
<span class="r-in"><span><span class="co"># ######################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">=</span> <span class="fl">2</span> <span class="co"># output dimension</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">=</span> <span class="fl">1</span> <span class="co"># order of c(z)</span></span></span>
<span class="r-in"><span><span class="va">q</span> <span class="op">=</span> <span class="fl">1</span> <span class="co"># order of d(z)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># model structure with lower triangular sigma_L</span></span></span>
<span class="r-in"><span><span class="va">tmpl</span> <span class="op">=</span> <span class="fu">tmpl_rmfd_pq</span><span class="op">(</span><span class="va">m</span>, n <span class="op">=</span> <span class="va">m</span>, <span class="va">p</span>, <span class="va">q</span>, sigma_L <span class="op">=</span> <span class="st">"chol"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">th</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">tmpl</span><span class="op">$</span><span class="va">n.par</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">th</span> <span class="op">=</span> <span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">tmpl</span><span class="op">$</span><span class="va">n.par</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="fill_template.html">fill_template</a></span><span class="op">(</span><span class="va">th</span>, <span class="va">tmpl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMFD model [2,2] with orders p = 1 and q = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> right factor polynomial c(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0       -1    -5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1       -2    -6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> left factor polynomial d(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0       -3    -7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1       -4    -8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Left square root of noise covariance Sigma:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      u[1] u[2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[1]   -9    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[2]  -10  -11</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># model structure with symmetric sigma_L</span></span></span>
<span class="r-in"><span><span class="va">tmpl</span> <span class="op">=</span> <span class="fu">tmpl_rmfd_pq</span><span class="op">(</span><span class="va">m</span>, n <span class="op">=</span> <span class="va">m</span>, <span class="va">p</span>, <span class="va">q</span>, sigma_L <span class="op">=</span> <span class="st">"symm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="fill_template.html">fill_template</a></span><span class="op">(</span><span class="va">th</span>, <span class="va">tmpl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMFD model [2,2] with orders p = 1 and q = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> right factor polynomial c(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0       -1    -5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1       -2    -6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> left factor polynomial d(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0       -3    -7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1       -4    -8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Left square root of noise covariance Sigma:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      u[1] u[2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[1]   -9  -10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[2]  -10  -11</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># model structure with sigma_L = I</span></span></span>
<span class="r-in"><span><span class="va">tmpl</span> <span class="op">=</span> <span class="fu">tmpl_rmfd_pq</span><span class="op">(</span><span class="va">m</span>, n <span class="op">=</span> <span class="va">m</span>, <span class="va">p</span>, <span class="va">q</span>, sigma_L <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># here the number of free paramaters is of course (by 3) smaller</span></span></span>
<span class="r-in"><span><span class="co"># than for the above model structures!</span></span></span>
<span class="r-in"><span><span class="fu"><a href="fill_template.html">fill_template</a></span><span class="op">(</span><span class="va">th</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">th</span><span class="op">)</span><span class="op">-</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span>, <span class="va">tmpl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMFD model [2,2] with orders p = 1 and q = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> right factor polynomial c(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0       -1    -5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1       -2    -6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> left factor polynomial d(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2] z^1 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0       -3    -7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1       -4    -8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Left square root of noise covariance Sigma:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      u[1] u[2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[1]    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[2]    0    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a template</span></span></span>
<span class="r-in"><span><span class="va">tmpl</span> <span class="op">&lt;-</span> <span class="fu">tmpl_rmfd_echelon</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in tmpl_rmfd_echelon():</span> argument "nu" is missing, with no default</span>
<span class="r-in"><span><span class="va">tmpl</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $h</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1 0 0 0 1 0 0 0 0 1 0 0 0 1 0 0 1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $H</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]    1    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]    0    1    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]    0    0    1    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]    0    0    0    1    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]    0    0    0    0    1    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]    0    0    0    0    0    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]    0    0    0    0    0    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]    0    0    0    0    0    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "rmfdmod"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $order</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 2 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.par</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use the template with fill_template()</span></span></span>
<span class="r-in"><span><span class="co"># filled &lt;- fill_template(tmpl, theta = rnorm(tmpl$n.par))</span></span></span>
<span class="r-in"><span><span class="co"># Create a template</span></span></span>
<span class="r-in"><span><span class="va">tmpl</span> <span class="op">&lt;-</span> <span class="fu">tmpl_stsp_full</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in tmpl_stsp_full():</span> argument "m" is missing, with no default</span>
<span class="r-in"><span><span class="va">tmpl</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $h</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1 0 0 0 1 0 0 0 0 1 0 0 0 1 0 0 1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $H</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]    1    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]    0    1    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]    0    0    1    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]    0    0    0    1    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]    0    0    0    0    1    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]    0    0    0    0    0    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]    0    0    0    0    0    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]    0    0    0    0    0    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "rmfdmod"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $order</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 2 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.par</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use the template with fill_template()</span></span></span>
<span class="r-in"><span><span class="co"># filled &lt;- fill_template(tmpl, theta = rnorm(tmpl$n.par))</span></span></span>
<span class="r-in"><span><span class="co"># Create a template</span></span></span>
<span class="r-in"><span><span class="va">tmpl</span> <span class="op">&lt;-</span> <span class="fu">tmpl_stsp_ar</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in tmpl_stsp_ar():</span> argument "m" is missing, with no default</span>
<span class="r-in"><span><span class="va">tmpl</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $h</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1 0 0 0 1 0 0 0 0 1 0 0 0 1 0 0 1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $H</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]    1    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]    0    1    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]    0    0    1    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]    0    0    0    1    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]    0    0    0    0    1    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]    0    0    0    0    0    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]    0    0    0    0    0    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]    0    0    0    0    0    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]    0    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "rmfdmod"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $order</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 2 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.par</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use the template with fill_template()</span></span></span>
<span class="r-in"><span><span class="co"># filled &lt;- fill_template(tmpl, theta = rnorm(tmpl$n.par))</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ######################################################</span></span></span>
<span class="r-in"><span><span class="co"># state space models in echelon form</span></span></span>
<span class="r-in"><span><span class="co"># ######################################################</span></span></span>
<span class="r-in"><span><span class="va">nu</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>   <span class="co"># Kronecker indices</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">nu</span><span class="op">)</span>  <span class="co"># number of outputs/inputs</span></span></span>
<span class="r-in"><span><span class="va">tmpl</span> <span class="op">=</span> <span class="fu">tmpl_stsp_echelon</span><span class="op">(</span>nu <span class="op">=</span> <span class="va">nu</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generate a random vector of parameters.</span></span></span>
<span class="r-in"><span><span class="co"># Note that "tmpl$n.par" contains the number free parameters.</span></span></span>
<span class="r-in"><span><span class="va">th</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">tmpl</span><span class="op">$</span><span class="va">n.par</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generate a model according to this structure with the parameters th</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="fill_template.html">fill_template</a></span><span class="op">(</span><span class="va">th</span>, <span class="va">tmpl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> state space model [3,3] with s = 9 states</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             s[1]        s[2]       s[3]        s[4]     s[5]       s[6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[1]  0.00000000  0.00000000  0.0000000  1.00000000 0.000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[2]  0.00000000  0.00000000  0.0000000  0.00000000 1.000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[3]  0.00000000  0.00000000  0.0000000  0.00000000 0.000000  1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[4]  0.00000000  0.00000000  0.0000000  0.00000000 0.000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[5] -0.56187636  1.59850877  0.6307541 -0.52111732 1.300199 -0.1331510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[6]  0.00000000  0.00000000  0.0000000  0.00000000 0.000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[7] -0.34391723 -0.08856511 -0.1136399 -0.48987045 2.293079 -1.7565274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[8]  0.00000000  0.00000000  0.0000000  0.00000000 0.000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[9]  0.09049665  1.08079950 -1.5329020  0.04715443 1.547581 -0.3887799</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[1]  1.00000000  0.00000000  0.0000000  0.00000000 0.000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[2]  0.00000000  1.00000000  0.0000000  0.00000000 0.000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[3]  0.00000000  0.00000000  1.0000000  0.00000000 0.000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            s[7]       s[8]     s[9]        u[1]       u[2]        u[3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[1] 0.00000000  0.0000000 0.000000 -0.44655722  0.1181445 -0.57746800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[2] 0.00000000  0.0000000 0.000000  0.17480270  0.1340386  2.00248273</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[3] 0.00000000  0.0000000 0.000000  0.07455118  0.2210195  0.06670087</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[4] 1.00000000  0.0000000 0.000000  0.42816676  1.6408462  1.86685184</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[5] 0.08920722  0.0000000 0.000000  0.02467498 -0.2190504 -1.35090269</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[6] 0.00000000  1.0000000 0.000000 -1.66747510  0.1680654  0.02098359</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[7] 0.84501300  0.6843094 0.000000  0.73649596  1.1683839  1.24991457</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[8] 0.00000000  0.0000000 1.000000  0.38602657  1.0541810 -0.71524219</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[9] 0.96252797 -1.3952743 0.849643 -0.26565163  1.1452631 -0.75268897</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[1] 0.00000000  0.0000000 0.000000  1.00000000  0.0000000  0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[2] 0.00000000  0.0000000 0.000000  0.00000000  1.0000000  0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x[3] 0.00000000  0.0000000 0.000000  0.00000000  0.0000000  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Left square root of noise covariance Sigma:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            u[1]       u[2]      u[3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[1] -0.9385387  0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[2] -1.0525133  0.3311792 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[3] -0.4371595 -2.0142105 0.2119804</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># we can extract the free parameters from this given model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">th</span>, <span class="fu"><a href="fill_template.html">extract_theta</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">tmpl</span>, on_error <span class="op">=</span> <span class="st">'stop'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># check the impulse response</span></span></span>
<span class="r-in"><span><span class="va">k</span> <span class="op">=</span> <span class="fu"><a href="impresp.html">impresp</a></span><span class="op">(</span><span class="va">model</span>, lag.max <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">nu</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the lag zero coeffcient k[0] is equal to the identity</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="va">k</span><span class="op">$</span><span class="va">irf</span><span class="op">)</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># check the Kronecker indices</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu">rationalmatrices</span><span class="fu">::</span><span class="fu"><a href="https://bfunovits.github.io/rationalmatrices/reference/Kronecker-Indices.html" class="external-link">pseries2nu</a></span><span class="op">(</span><span class="va">k</span><span class="op">$</span><span class="va">irf</span><span class="op">)</span>, <span class="va">nu</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://scholar.google.com/citations?user=-Ytb9BYAAAAJ" class="external-link">Wolfgang Scherrer</a>, <a href="https://ch.linkedin.com/in/bernd-funovits-phd-cfa-a8215016" class="external-link">Bernd Funovits</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

