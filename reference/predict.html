<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Model Predictions — predict • RLDM</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model Predictions — predict"><meta name="description" content='Compute the forecasts based on a VARMA or state space model. The procedure implements a simplified approach.
It uses the formulas for the prediction from an infinite past and sets the unknown initial values
(prior to \(t &amp;lt; 1\)) simply to zero. This simple approach assumes that the model is stable and
strictly miniphase and thus the disturbances \(u_t\) are the innovations of the process.
Note also that the forecasts for known exogenous inputs
are calculated, i.e. the "conditional forecasts". For an honest prediction,
forecasts of the exogenous inputs should be used.

The forecast error covariance matrix computed assumes that the true model is used.
The error which stems from the estimation of the model is not taken into account.


The utility function evaluate_prediction may be used to assess the quality of predictions.'><meta property="og:description" content='Compute the forecasts based on a VARMA or state space model. The procedure implements a simplified approach.
It uses the formulas for the prediction from an infinite past and sets the unknown initial values
(prior to \(t &amp;lt; 1\)) simply to zero. This simple approach assumes that the model is stable and
strictly miniphase and thus the disturbances \(u_t\) are the innovations of the process.
Note also that the forecasts for known exogenous inputs
are calculated, i.e. the "conditional forecasts". For an honest prediction,
forecasts of the exogenous inputs should be used.

The forecast error covariance matrix computed assumes that the true model is used.
The error which stems from the estimation of the model is not taken into account.


The utility function evaluate_prediction may be used to assess the quality of predictions.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RLDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9006</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/0_getting_started.html">Getting Started with RLDM</a></li>
    <li><a class="dropdown-item" href="../articles/1_case_study.html">Case Study: Economic Data Analysis with RLDM</a></li>
    <li><a class="dropdown-item" href="../articles/2_technical_reference.html">Technical Reference: RLDM Classes and Methods</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bfunovits/RLDM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Model Predictions</h1>

      <div class="d-none name"><code>predict.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute the forecasts based on a VARMA or state space model. The procedure implements a simplified approach.
It uses the formulas for the prediction from an infinite past and sets the unknown initial values
(prior to \(t &lt; 1\)) simply to zero. This simple approach assumes that the model is <em>stable</em> and
<em>strictly miniphase</em> and thus the disturbances \(u_t\) are the innovations of the process.
Note also that the forecasts for <em>known</em> exogenous inputs
are calculated, i.e. the "conditional forecasts". For an <em>honest</em> prediction,
forecasts of the exogenous inputs should be used.
<br>
The forecast error covariance matrix computed assumes that the true model is used.
The error which stems from the estimation of the model is not taken into account.
<br><br>
The utility function <code>evaluate_prediction</code> may be used to assess the quality of predictions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'armamod'</span></span>
<span><span class="fu">predict</span><span class="op">(</span><span class="va">object</span>, <span class="va">y</span>, h <span class="op">=</span> <span class="fl">1</span>, n.ahead <span class="op">=</span> <span class="fl">0</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'stspmod'</span></span>
<span><span class="fu">predict</span><span class="op">(</span><span class="va">object</span>, <span class="va">y</span>, <span class="va">x</span>, h <span class="op">=</span> <span class="fl">1</span>, n.ahead <span class="op">=</span> <span class="fl">0</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">evaluate_prediction</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">yhat</span>,</span>
<span>  <span class="va">h</span>,</span>
<span>  criteria <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"RMSE"</span><span class="op">)</span>,</span>
<span>  benchmark <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  samples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p><code>rldm_varma</code> or <code>rldm_ss</code> object which represents the model.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>\((T,n)\) matrix with the observed outputs (\(y_t\), \(t=1,...,T\)).</p></dd>


<dt id="arg-h">h<a class="anchor" aria-label="anchor" href="#arg-h"></a></dt>
<dd><p>(integer) vector of forecast horizons.</p></dd>


<dt id="arg-n-ahead">n.ahead<a class="anchor" aria-label="anchor" href="#arg-n-ahead"></a></dt>
<dd><p>(integer) number of time steps to look ahead (out of sample). This number is
also denoted with \(T_0\).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>not used.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>\((T+T_0,r)\) matrix with the exogenous inputs
(\(x_t\), \(t=1,...,T+T_0\)). This input parameter is ignored,
if the model has no exogenous inputs. Note that the condition forecasts
are computed and hence (for a model with exogenous inputs) we need the
values of the inputs up to time \(t=T+T_0\).</p></dd>


<dt id="arg-yhat">yhat<a class="anchor" aria-label="anchor" href="#arg-yhat"></a></dt>
<dd><p>\((T,n,l)\) dimensional array of forecasts. The entries <code>yhat[t,,i]</code>
should contain the prediction for \(y_t\).</p></dd>


<dt id="arg-criteria">criteria<a class="anchor" aria-label="anchor" href="#arg-criteria"></a></dt>
<dd><p>is a list with "evaluation criteria". See below for more details.</p></dd>


<dt id="arg-benchmark">benchmark<a class="anchor" aria-label="anchor" href="#arg-benchmark"></a></dt>
<dd><p>\((T,n,l)\) dimensional array with "benchmark" forecasts. If <code>NULL</code>
then the naive (\(h\)-step ahead) forecasts are used as benchmark.</p></dd>


<dt id="arg-samples">samples<a class="anchor" aria-label="anchor" href="#arg-samples"></a></dt>
<dd><p>is a list with "(sub) samples". See below for more details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function <code>predict</code> returns a list with components</p>
<dl><dt>yhat</dt>
<dd><p>\((T,n,l)\) dimensional array for the h-step ahead forecast. \(T\)
is the sample size, \(n\) is the dimension of the outputs \(y_t\)
and \(l\) is the number of forecasts made, i.e. the length of the
vector <code>h</code>. The entries <code>yhat[t,,i]</code> are the <code>h[i]</code>-step
ahead forecast for \(y_t\).</p></dd>

<dt>sigmahat</dt>
<dd><p>\((n,n,l)\) dimensional array, where <code>sigmahat[,,i]</code> contains the theoretical
covariance matrix of the \(h\)-step ahead prediction error for <code>h=h[i]</code>.</p></dd>

<dt>h</dt>
<dd><p>the (integer) vector of forecasts horizons considered.</p></dd>

<dt>yhat.ahead</dt>
<dd><p>\((T_0,n)\) dimensional matrix, which contains the "out-of-sample" forecasts
for \(t=T+1, t=T+2,...,t=T+T_0\).</p></dd>

<dt>sigmahat.ahead</dt>
<dd><p>\((n,n,T_0)\) dimensional array, where <code>sigmahat.ahead[,,h]</code>
contains the theoretical covariance matrix of the \(h\)-step ahead prediction
error.</p></dd>

<dt>y,x</dt>
<dd><p>the original data.</p></dd>

</dl><p>The function <code>evaluate_prediction</code>  returns a 4-dimensional array where the dimensions refer to
the evaluation criteria, the (sub) samples, the predictors and the components of the output \(y_t\).
Note that the evaluation criteria are applied to the (\(n\)) individual components as well as to
the joint vector and hence the 4-th dimension of the array has size \(n+1\).
E.g. if we consider the "RMSE" and the "MAE" of the forecast errors, two samples (a training sample and a
test sample), 5 forecast horizons \(h=1,\ldots,5\) and a process
\((y_t)\) with 2 components, then the result will be a \((2,2,5,3)\)-dimensional array.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The utility function <code>evaluate_prediction</code> may be used to asses the quality of some given predictions.
(E.g. as computed by <code>predict</code>). The evaluation criteria to be used are passed as parameter <code>criteria</code>
to the function. This parameter is a list with components which are either character strings (for selection of
one of the implemented quality measures) or a user defined function. Such a function takes three arguments
<code>fun(uhat, y, utilde)</code> where <code>uhat</code> is a matrix of prediction errors,
<code>y</code> is a matrix of the (corresponding) true values and <code>ytilde</code> is a matrix with
the predictions of a benchmark prediction procedures. This allows to compute relative error measures.</p>
<p>The benchmark predictions are passed on via the parameter <code>benchmark</code> to the procedure.
If this input parameter is missing then the naive \(h\)-step ahead predictions are used a benchmark.
(Therefore the user also has to specify the respective forecast horizons via the paramater <code>h</code>.)</p>
<p>The following evaluation criteria are implemented (\(\hat{y}_{it}\) denotes
the prediction error for \(y_{it}\) and \(\tilde{u}_{it}\) is the corresponding
error of the benchmark procedure.)</p><dl><dt>MSE</dt>
<dd><p>Mean Square Error</p></dd>

<dt>RMSE</dt>
<dd><p>Root Mean Square Error</p></dd>

<dt>MAE</dt>
<dd><p>Mean Absolute Error</p></dd>

<dt>MdAE</dt>
<dd><p>Median Absolute Error</p></dd>

<dt>MAPE</dt>
<dd><p>Mean Absolute Percentage Error
\(100 mean(|\hat{u}_{it}/y_{it}|)\)</p></dd>

<dt>MdAPE</dt>
<dd><p>Median Absolute Percentage Error
\(100 median(|\hat{u}_{it}/y_{it}|)\)</p></dd>

<dt>RMdSPE</dt>
<dd><p>Root Median Square Percentage Error
\(100 \sqrt{median(\hat{u}^2_{it}/y^2_{it})}\)</p></dd>

<dt>RelRMSE</dt>
<dd><p>Relative Root Mean Square Error
\(\sqrt{mean(\hat{u}^2_{it})}/\sqrt{mean(\tilde{u}^2_{it})}\)</p></dd>

<dt>RelMAE</dt>
<dd><p>Relative Mean Absolute Error
\(mean(|\hat{u}_{it}|)/mean(|\tilde{u}^2_{it}|)\)</p></dd>

<dt>PB</dt>
<dd><p>Percentage better
\(mean(100 I(|\hat{u}_{it}|&lt; |\tilde{u}_{it}|))\)</p></dd>

<dt>HR</dt>
<dd><p>Hit Rate
\(100 mean( I((\tilde{u}_{it} - \hat{u}_{it})\tilde{u}_{it} \geq 0))\).
To be precise this measure computes the hit rate only if the naive prediction is the benchmark.</p></dd>


</dl><p>The procedure also supports the evaluation on different (sub) samples.
The parameter <code>samples</code> is simply list of integer vectors, where each vector defines a sub sample.
E.g. for daily data, one could evaluate the predictions for different weekdays.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create a "random" ARMA(1,1) model (stable and miniphase)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="test_armamod.html">test_armamod</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, degrees <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, bpoles <span class="op">=</span> <span class="fl">1</span>, bzeroes <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generate data (sample size n.obs = 200, "burn_in" phase has length 100.)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="sim.html">sim</a></span><span class="op">(</span><span class="va">model</span>, n.obs <span class="op">=</span> <span class="fl">200</span>, n.burn_in <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predict with true model</span></span></span>
<span class="r-in"><span><span class="va">pred_true</span> <span class="op">=</span> <span class="fu">predict</span><span class="op">(</span><span class="va">model</span>, <span class="va">data</span><span class="op">$</span><span class="va">y</span>, h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimate AR model, order selection by AIC</span></span></span>
<span class="r-in"><span><span class="va">n.train</span> <span class="op">=</span> <span class="fl">110</span>   <span class="co"># use the first 110 observation for estimation</span></span></span>
<span class="r-in"><span><span class="va">n.test</span> <span class="op">=</span> <span class="fl">90</span>     <span class="co"># the last 90 observations are used for (a fair) comparison</span></span></span>
<span class="r-in"><span><span class="va">model_ar</span> <span class="op">=</span> <span class="fu"><a href="est_ar.html">est_ar</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n.train</span>,<span class="op">]</span>,  mean_estimate <span class="op">=</span> <span class="st">"zero"</span>,</span></span>
<span class="r-in"><span>                  ic <span class="op">=</span> <span class="st">'AIC'</span>, method <span class="op">=</span> <span class="st">'ols'</span><span class="op">)</span><span class="op">$</span><span class="va">model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predict with AR model</span></span></span>
<span class="r-in"><span><span class="va">pred_ar</span> <span class="op">=</span> <span class="fu">predict</span><span class="op">(</span><span class="va">model_ar</span>, <span class="va">data</span><span class="op">$</span><span class="va">y</span>, h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimate AR1 model (Yule-Walker)</span></span></span>
<span class="r-in"><span><span class="va">model_ar1</span> <span class="op">=</span> <span class="fu"><a href="est_ar.html">est_ar</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n.train</span>,<span class="op">]</span>,  mean_estimate <span class="op">=</span> <span class="st">"zero"</span>,</span></span>
<span class="r-in"><span>                  penalty <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, p.max <span class="op">=</span> <span class="fl">1</span>, method <span class="op">=</span> <span class="st">'yule-walker'</span><span class="op">)</span><span class="op">$</span><span class="va">model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predict with AR1 model</span></span></span>
<span class="r-in"><span><span class="va">pred_ar1</span> <span class="op">=</span> <span class="fu">predict</span><span class="op">(</span><span class="va">model_ar1</span>, <span class="va">data</span><span class="op">$</span><span class="va">y</span>, h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># evaluate prediction of the AR model (with the AR1 prediction as benchmark)</span></span></span>
<span class="r-in"><span><span class="va">stats</span> <span class="op">=</span> <span class="fu">evaluate_prediction</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, <span class="va">pred_ar</span><span class="op">$</span><span class="va">yhat</span>, h <span class="op">=</span> <span class="va">pred_ar</span><span class="op">$</span><span class="va">h</span>,</span></span>
<span class="r-in"><span>                            criteria <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">'RMSE'</span>, <span class="st">'MAE'</span>, <span class="st">'PB'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            samples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>train <span class="op">=</span> <span class="fl">21</span><span class="op">:</span><span class="va">n.train</span>, test <span class="op">=</span> <span class="op">(</span><span class="va">n.train</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">n.train</span><span class="op">+</span><span class="va">n.test</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            benchmark <span class="op">=</span> <span class="va">pred_ar1</span><span class="op">$</span><span class="va">yhat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use array2data.frame for "tabular" display of the results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">array2data.frame</span><span class="op">(</span><span class="va">stats</span>, rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, cols <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    criterion sample predictor       y[1]       y[2]      total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       RMSE  train       h=1  0.7464332  0.3151248  0.5729163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        MAE  train       h=1  0.6062208  0.2463317  0.4262762</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         PB  train       h=1 51.1111111 53.3333333 52.2222222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       RMSE   test       h=1  0.8366101  0.3777231  0.6490729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        MAE   test       h=1  0.6926596  0.3086385  0.5006490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6         PB   test       h=1 51.1111111 58.8888889 55.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       RMSE  train       h=5  1.0158984  1.2603229  1.1446535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8        MAE  train       h=5  0.8077797  0.9870565  0.8974181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9         PB  train       h=5 58.8888889 61.1111111 60.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      RMSE   test       h=5  1.3325549  1.6976224  1.5260446</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11       MAE   test       h=5  1.1201251  1.4008479  1.2604865</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12        PB   test       h=5 58.8888889 57.7777778 58.3333333</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># evaluate all predictions</span></span></span>
<span class="r-in"><span><span class="co"># join predictions</span></span></span>
<span class="r-in"><span><span class="va">yhat</span>  <span class="op">=</span> <span class="fu">dbind</span><span class="op">(</span><span class="fl">3</span>, <span class="va">pred_true</span><span class="op">$</span><span class="va">yhat</span>, <span class="va">pred_ar1</span><span class="op">$</span><span class="va">yhat</span>, <span class="va">pred_ar</span><span class="op">$</span><span class="va">yhat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># define a function to compute the "Median Relative Absolute Error"</span></span></span>
<span class="r-in"><span><span class="va">MdRAE_</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">u.hat</span>, <span class="va">y</span>, <span class="va">u.bench</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">u.hat</span><span class="op">/</span><span class="va">u.bench</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">stats</span> <span class="op">=</span> <span class="fu">evaluate_prediction</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, <span class="va">yhat</span>,</span></span>
<span class="r-in"><span>                            h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pred_true</span><span class="op">$</span><span class="va">h</span>, <span class="va">pred_ar1</span><span class="op">$</span><span class="va">h</span>, <span class="va">pred_ar</span><span class="op">$</span><span class="va">h</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            criteria <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">'RMSE'</span>, <span class="st">'MAE'</span>, MdRAE <span class="op">=</span> <span class="va">MdRAE_</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            samples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>train <span class="op">=</span> <span class="fl">21</span><span class="op">:</span><span class="va">n.train</span>, test <span class="op">=</span> <span class="op">(</span><span class="va">n.train</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">n.train</span><span class="op">+</span><span class="va">n.test</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># split prediction method and forecast horizon</span></span></span>
<span class="r-in"><span><span class="va">dimnames.stats</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">stats</span> <span class="op">=</span> <span class="va">stats</span><span class="op">[</span>,,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>criterion <span class="op">=</span> <span class="va">dimnames.stats</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, sample <span class="op">=</span> <span class="va">dimnames.stats</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                      model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'true'</span>,<span class="st">'AR1'</span>,<span class="st">'AR'</span><span class="op">)</span>, h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'h='</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span>,sep<span class="op">=</span><span class="st">''</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      data <span class="op">=</span> <span class="va">dimnames.stats</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use array2data.frame for "tabular" display of the results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">array2data.frame</span><span class="op">(</span><span class="va">stats</span>, cols <span class="op">=</span> <span class="fl">5</span>, rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    model   h criterion sample      y[1]      y[2]     total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   true h=1      RMSE  train 0.7477685 0.3209361 0.5753945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    AR1 h=1      RMSE  train 0.7834196 0.3220445 0.5989403</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     AR h=1      RMSE  train 0.7464332 0.3151248 0.5729163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   true h=5      RMSE  train 1.0201199 1.2700194 1.1518667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    AR1 h=5      RMSE  train 1.0610705 1.3159654 1.1953317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     AR h=5      RMSE  train 1.0158984 1.2603229 1.1446535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   true h=1       MAE  train 0.6067455 0.2514219 0.4290837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    AR1 h=1       MAE  train 0.6289440 0.2544288 0.4416864</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     AR h=1       MAE  train 0.6062208 0.2463317 0.4262762</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  true h=5       MAE  train 0.8103448 0.9980458 0.9041953</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11   AR1 h=5       MAE  train 0.8415633 1.0457366 0.9436500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    AR h=5       MAE  train 0.8077797 0.9870565 0.8974181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  true h=1     MdRAE  train 0.3716322 0.1601011 0.2134180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14   AR1 h=1     MdRAE  train 0.4362900 0.1380195 0.2473105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    AR h=1     MdRAE  train 0.3802291 0.1474111 0.2204019</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  true h=5     MdRAE  train 0.7182880 0.7885423 0.7817148</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17   AR1 h=5     MdRAE  train 0.8268266 0.9668042 0.8919780</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18    AR h=5     MdRAE  train 0.7301805 0.8001168 0.7869697</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  true h=1      RMSE   test 0.8363547 0.3743463 0.6479292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20   AR1 h=1      RMSE   test 0.8721171 0.3993802 0.6782672</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21    AR h=1      RMSE   test 0.8366101 0.3777231 0.6490729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  true h=5      RMSE   test 1.3292630 1.6959861 1.5236976</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23   AR1 h=5      RMSE   test 1.4364223 1.8304275 1.6452620</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24    AR h=5      RMSE   test 1.3325549 1.6976224 1.5260446</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  true h=1       MAE   test 0.6920242 0.3055231 0.4987736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26   AR1 h=1       MAE   test 0.7095644 0.3273742 0.5184693</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27    AR h=1       MAE   test 0.6926596 0.3086385 0.5006490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  true h=5       MAE   test 1.1179249 1.3852854 1.2516052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29   AR1 h=5       MAE   test 1.2084904 1.5380311 1.3732607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30    AR h=5       MAE   test 1.1201251 1.4008479 1.2604865</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31  true h=1     MdRAE   test 0.3303844 0.1110197 0.2029135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32   AR1 h=1     MdRAE   test 0.3618924 0.1324323 0.2163938</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33    AR h=1     MdRAE   test 0.3462281 0.1021306 0.2055096</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34  true h=5     MdRAE   test 0.8782822 0.8480689 0.8562370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35   AR1 h=5     MdRAE   test 0.8941141 0.9805714 0.9360010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36    AR h=5     MdRAE   test 0.8840215 0.8551495 0.8651375</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://scholar.google.com/citations?user=-Ytb9BYAAAAJ" class="external-link">Wolfgang Scherrer</a>, <a href="https://ch.linkedin.com/in/bernd-funovits-phd-cfa-a8215016" class="external-link">Bernd Funovits</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

