<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Hannan, Rissanen, Kavalieris estimation procedure — est_arma_hrk • RLDM</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Hannan, Rissanen, Kavalieris estimation procedure — est_arma_hrk"><meta name="description" content="
Estimate (V)ARMA models with the Hannan, Rissanen Kavalieris procedure, see
e.g. (Hannan and Rissanen 1982)
 and (Hannan et al. 1986)
."><meta property="og:description" content="
Estimate (V)ARMA models with the Hannan, Rissanen Kavalieris procedure, see
e.g. (Hannan and Rissanen 1982)
 and (Hannan et al. 1986)
."><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RLDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9006</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/0_getting_started.html">Getting Started with RLDM</a></li>
    <li><a class="dropdown-item" href="../articles/1_case_study.html">Case Study: Economic Data Analysis with RLDM</a></li>
    <li><a class="dropdown-item" href="../articles/2_technical_reference.html">Technical Reference: RLDM Classes and Methods</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bfunovits/RLDM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Hannan, Rissanen, Kavalieris estimation procedure</h1>

      <div class="d-none name"><code>est_arma_hrk.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a>
Estimate (V)ARMA models with the Hannan, Rissanen Kavalieris procedure, see
e.g. (Hannan and Rissanen 1982)
 and (Hannan et al. 1986)
.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">est_arma_hrk</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  e <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">tmpl</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  trace <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  p.max <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AIC"</span>, <span class="st">"BIC"</span>, <span class="st">"max"</span><span class="op">)</span>,</span>
<span>  mean_estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample.mean"</span>, <span class="st">"intercept"</span>, <span class="st">"zero"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>sample, i.e. an \((N,m)\) dimensional matrix,
or a "time series" object (i.e. <code>as.matrix(y)</code> should return an
\((N,m)\)-dimensional numeric matrix). Missing values (<code>NA</code>, <code>NaN</code> and
<code>Inf</code>) are <strong>not</strong> supported.</p></dd>


<dt id="arg-e">e<a class="anchor" aria-label="anchor" href="#arg-e"></a></dt>
<dd><p>(initial) estimate of the disturbances \(u_t\).
If non <code>NULL</code> then <code>e</code> has to be an \((N,m)\) dimensional matrix,
or a "time series" object (i.e an object which may be coerced to an \((N,m)\)
dimensional matrix with <code>as.matrix(e)</code>).
<br>
If <code>NULL</code> then the procedure computes an estimate of the disturbances by fitting
a "long" AR model to the data, see <code><a href="est_ar.html">est_ar_ols()</a></code>.
<br>
The matrix <code>e</code> may contain missing values (<code>NA</code>, <code>NaN</code> and
<code>Inf</code>). Note that e.g. <code>est_ar_ols</code> returns residuals where the first
\(p\) (here \(p\) refers to the order of the fitted AR model) values are missing.</p></dd>


<dt id="arg-tmpl">tmpl<a class="anchor" aria-label="anchor" href="#arg-tmpl"></a></dt>
<dd><p>a model template, see <code><a href="model_structures.html">model structures()</a></code>. Note that only the case
is implemented, where
\(a_0=b_0\) holds, the diagonal entries of
\(a_0=b_0\) are equal to one and all other fixed elements
are equal to zero. Furthermore the square root <code>sigma_L</code> of the noise covariance matrix
is asssumed to be a lower triangular matrix without any further restrictions.
<br>
The given template is coerced to a template of this kind. If the given template does not
comply to these restrictions, then a warning message is issued.</p></dd>


<dt id="arg-maxit">maxit<a class="anchor" aria-label="anchor" href="#arg-maxit"></a></dt>
<dd><p>(integer) maximum number of iterations</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>(numeric) tolerance level</p></dd>


<dt id="arg-trace">trace<a class="anchor" aria-label="anchor" href="#arg-trace"></a></dt>
<dd><p>(boolean) if <code>trace=TRUE</code>, then some tracing information on the
iterations is printed.</p></dd>


<dt id="arg-p-max">p.max<a class="anchor" aria-label="anchor" href="#arg-p-max"></a></dt>
<dd><p>(integer or <code>NULL</code>) Maximum order of the candidate AR models.
For the default choice see below.</p></dd>


<dt id="arg-ic">ic<a class="anchor" aria-label="anchor" href="#arg-ic"></a></dt>
<dd><p>(character string) Which information criterion shall be used to find the
optimal AR order. Note that <code>ic="max"</code> means that an AR(p) model
with <code>p=p.max</code> is fitted. Default is <code>ic="AIC"</code>.</p></dd>


<dt id="arg-mean-estimate">mean_estimate<a class="anchor" aria-label="anchor" href="#arg-mean-estimate"></a></dt>
<dd><p>Character string giving the method used to estimate the mean \(\mu\).
Default is <code>mean_estimate = "sample.mean"</code>.
See the details below.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List with components</p>
<dl><dt>model</dt>
<dd><p>the estimated (V)ARMA model (i.e. an <code><a href="armamod.html">armamod()</a></code> object).</p></dd>

<dt>th</dt>
<dd><p>vector with the (free) parameters of the estimated (V)ARMA model.</p></dd>

<dt>tmpl</dt>
<dd><p>the (coerced) model template.</p></dd>

<dt>y.mean</dt>
<dd><p>estimate of the mean \(\mu\).</p></dd>

<dt>residuals</dt>
<dd><p>the residuals of the model, computed with <code><a href="solve_de.html">solve_inverse_de()</a></code>.</p></dd>

<dt>sigma</dt>
<dd><p>the sample variance \(S\) of the residuals, i.e. an estimate of the
noise covariance matrix \(\Sigma\).</p></dd>

<dt>n.valid</dt>
<dd><p>number of "valid" observations, i.e. observations where all needed
lagged values \(y_{t-i}\) and \(e_{t-i}\)
are availiable. For an ARMA(p,q) model this implies
that the number of valid observations is less than or equal
to <code>n.obs -max(p,q)</code>.</p></dd>

<dt>ll</dt>
<dd><p>Gaussian log likelihood:
$$(-1/2)(m \ln(2\pi) + m + \ln\det(S))$$
where \(S\) denotes the sample variance of the residuals.</p></dd>

<dt>iter</dt>
<dd><p>number of iterations.</p></dd>

<dt>converged</dt>
<dd><p>(boolean) indicates whether the algorithm converged.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The main idea of the HRK procedure is as follows. If we have given estimates,
\(e_t\) say, of the disturbances,
then the ARMA model is estimated from the equation
$$y_t = -a^*_0(y_t+e_t) - a_1 y_{t-1} - \cdots - a_p y_{t-p} +
                b_1 e_{t-1} + \cdots + b_q e_{t-q} + v_{t-1}$$
where \(a^*_0\) is obtained from \(a_0 = b_0\) by setting all
diagonal elements equal to zero.
The entries in the parameter matrices \(a_i\) and \(b_i\) are
either treated as fixed (and equal to zero)
or "free". Now the above regression is estimated "componentwise", i.e. for
each component of \(y_t\) the corresponding
"free" parameters are estimated by OLS.</p>
<p>Given the parameter estimates one computes new estimates for the disturbances,
by recursively solving the ARMA system,
see <code><a href="solve_de.html">solve_inverse_de()</a></code>. The sample variance of these residuals is
used as an estimate of the
noise covariance matrix \(\Sigma\).</p>
<p>This procedure may be iterated: use the "new" estimates for the disturbances to (re) estimate
the ARMA parameters and to (re) estimate the disturbances, ...</p>
<p>The parameters <code>maxit</code> and <code>tol</code> control this iterative scheme. The
iterations are stopped after at most <code>maxit</code> iterations or when there is
only a "small" change of the estimates. To be more precise, if <code>th</code>,
<code>th0</code> denote the vector of parameter estimates in the actual round and
the previous round, then the procedure stops if <code>max(abs(th-th0)) &lt;= tol</code>.</p>
<p>Note that in general there is no guarantee that this iterative scheme
converges or that the estimates are improved by iterating.</p>
<p>The user may supply his "own" (initial) estimates <code>e</code> of the disturbances.
If the parameter <code>e</code> is missing (or <code>NULL</code>) then the procedure <code>est_arma_hrk</code>
computes estimates of the disturbances by fitting a "long" AR model to the data. To this end
the procedure simply calls <code><a href="est_ar.html">est_ar_ols()</a></code> with the respective paramaters
<code>p.max</code> (which controls the maximum possible AR order), <code>ic</code> (which controls the
information criterion used to select the order of the AR model) and <code>mean_estimate</code>
(which tells <code>est_ar_ols</code> how to estimate the mean \(\mu\)).
The default for the maximum order <code>p.max</code> is
$$\max(12, 10\log_{10}(N), (N-1)/(m+1))$$</p>
<p>The procedure supports three options for the estimation of the mean
\(\mu = \mathbf{E} y_t\). For <code>mean_estimate="zero"</code> the
procedure sets the (estimate of the) mean equal to zero. For
<code>mean_estimate="sample.mean"</code> the procedure simply uses the sample mean
of <code>y</code> as an estimate. Third option <code>mean_estimate="intercept"</code>
uses an intercept in the above regression(s) and computes the estimate of the
mean correspondingly. Note that this fails if the estimated AR polynomial has
a unit root, i.e. if $$\det \hat{a}(1) = 0.$$</p>
<p>There is no guarantee that the HRK algorithm returns a stable and minimum
phase ARMA model. In particular, if the estimated model is <em>not</em> minimum
phase then the recursive computation of the residuals often yields useless
results and correspondingly the cholesky decomposition of the sample variance
of the residuals (which is used as estimate of the noise covariance matrix
\(\Sigma\)) fails. In this case the procedure stops with an error message.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hannan EJ, Rissanen J (1982).
“Recursive estimation of mixed autoregressive-moving average order.”
<em>Biometrika</em>, <b>69</b>, 81–94.</p>
<p>Hannan EJ, Kavalieris L, Mackisack M (1986).
“Recursive Estimation of Linear Systems.”
<em>Biometrika</em>, <b>73</b>(1), 119-133.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># in order to get reproducible results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4321</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generate a random VARMA(p=2,q=1) model with m=2 outputs #####################</span></span></span>
<span class="r-in"><span><span class="va">tmpl</span> <span class="op">=</span> <span class="fu"><a href="model_structures.html">tmpl_arma_pq</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fl">2</span>, n <span class="op">=</span> <span class="fl">2</span>, p <span class="op">=</span> <span class="fl">2</span>, q <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="r_model.html">r_model</a></span><span class="op">(</span>template <span class="op">=</span> <span class="va">tmpl</span>, bpoles <span class="op">=</span> <span class="fl">1</span>, bzeroes <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">sigma_L</span><span class="op">)</span> <span class="op">=</span> <span class="fl">1</span> <span class="co"># scale the diagonal entries of sigma_L</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ARMA model [2,2] with orders p = 2 and q = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AR polynomial a(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]    z^1 [,1]      [,2]    z^2 [,1]        [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0 -0.10668935 0.1794017 -0.03208932 -0.07429186</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1 -0.05590295 0.2103614  0.40233680  0.04900116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MA polynomial b(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]   z^1 [,1]        [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0  0.3101866 -0.01680908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1 -0.1796745  0.08609177</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Left square root of noise covariance Sigma:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          u[1] u[2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[1] 1.000000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[2] 0.284866    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generate a sample with 200 observations</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="sim.html">sim</a></span><span class="op">(</span><span class="va">model</span>, n.obs <span class="op">=</span> <span class="fl">200</span>, n.burn_in <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimate model with HRK</span></span></span>
<span class="r-in"><span><span class="co"># note: we are cheating here and use the true disturbances!</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">=</span> <span class="fu">est_arma_hrk</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, <span class="va">data</span><span class="op">$</span><span class="va">u</span>, <span class="va">tmpl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HRK estimation of ARMA model: m=2, n.obs=200, p=2, q=1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter |th - th0|  n.val      MSE       ll </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1      0.977    198    1.958   -2.754  </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ARMA model [2,2] with orders p = 2 and q = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AR polynomial a(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]  z^1 [,1]        [,2]    z^2 [,1]        [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0 0.4774058 0.231267694 -0.08031496 -0.05099365</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1 0.1309504 0.005178953  0.33292233  0.06794187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MA polynomial b(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]   z^1 [,1]        [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0 0.86715882 -0.05585317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1 0.06883826 -0.24833582</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Left square root of noise covariance Sigma:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           u[1]      u[2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[1] 0.9772386 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[2] 0.3424949 0.9410523</span>
<span class="r-in"><span><span class="co"># ll() returns the same logLik value. However, we have to demean the data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">ll</span>, <span class="fu"><a href="ll.html">ll</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">model</span>, <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, center <span class="op">=</span> <span class="va">out</span><span class="op">$</span><span class="va">y.mean</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     <span class="st">'conditional'</span>, skip <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimate the model with HRK</span></span></span>
<span class="r-in"><span><span class="co"># use the residuals of a long AR model as estimates for the noise</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">=</span> <span class="fu">est_arma_hrk</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, e <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">tmpl</span>,</span></span>
<span class="r-in"><span>                   trace <span class="op">=</span> <span class="cn">TRUE</span>, maxit <span class="op">=</span> <span class="fl">10</span>, mean_estimate <span class="op">=</span> <span class="st">'zero'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HRK estimation of ARMA model: m=2, n.obs=200, p=2, q=1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial AR estimate of noise p.max=11, p=2, ll=-2.711726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter |th - th0|  n.val      MSE       ll </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1      0.939    197    1.865   -2.697  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2      0.140    198    1.856   -2.692  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3      0.060    198    1.856   -2.692  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4      0.018    198    1.856   -2.692  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5      0.007    198    1.856   -2.692  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    6      0.002    198    1.856   -2.692  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    7      0.002    198    1.856   -2.692  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    8      0.000    198    1.856   -2.692  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> algorithm converged</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ARMA model [2,2] with orders p = 2 and q = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AR polynomial a(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]   z^1 [,1]       [,2]   z^2 [,1]        [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0 0.20158389 0.13764630 0.05391753 -0.08392618</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1 0.06234842 0.09370431 0.37190127  0.05010730</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MA polynomial b(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]     z^1 [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0  0.615023757 -0.1511000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1 -0.001179974 -0.1500922</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Left square root of noise covariance Sigma:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           u[1]      u[2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[1] 0.9230599 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[2] 0.3558209 0.9364313</span>
<span class="r-in"><span><span class="co"># ll() returns the same logLik value. However, we have to demean the data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">ll</span>, <span class="fu"><a href="ll.html">ll</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">model</span>, <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, center <span class="op">=</span> <span class="va">out</span><span class="op">$</span><span class="va">y.mean</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     <span class="st">'conditional'</span>, skip <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate a random Model in echelon form model (m = 3) #######################</span></span></span>
<span class="r-in"><span><span class="va">tmpl</span> <span class="op">=</span> <span class="fu"><a href="model_structures.html">tmpl_arma_echelon</a></span><span class="op">(</span>nu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="r_model.html">r_model</a></span><span class="op">(</span>template <span class="op">=</span> <span class="va">tmpl</span>, bpoles <span class="op">=</span> <span class="fl">1</span>, bzeroes <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">sigma_L</span><span class="op">)</span> <span class="op">=</span> <span class="fl">1</span> <span class="co"># scale the diagonal entries of sigma_L</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ARMA model [3,3] with orders p = 1 and q = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AR polynomial a(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]  [,3]   z^1 [,1]        [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0     0  0.5893418 -0.00553193 -0.2113619</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1     0  0.1842932  0.06201503  0.1328532</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]        0     0     1 -0.1422159  0.23607602  0.3943483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MA polynomial b(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]  [,3]    z^1 [,1]       [,2]      [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0     0 -0.07942568 -0.1992309 0.5002033</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1     0 -0.29348965  0.1566674 0.1483497</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]        0     0     1 -0.14925189  0.4185160 0.3153198</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Left square root of noise covariance Sigma:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            u[1]      u[2] u[3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[1]  1.0000000 0.0000000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[2]  0.2661327 1.0000000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[3] -0.4719906 0.1258785    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generate a sample with 200 observations</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="sim.html">sim</a></span><span class="op">(</span><span class="va">model</span>, n.obs <span class="op">=</span> <span class="fl">200</span>, n.burn_in <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># add mean value(s)</span></span></span>
<span class="r-in"><span><span class="va">data</span><span class="op">$</span><span class="va">y</span> <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">y</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, nrow <span class="op">=</span> <span class="fl">200</span>, ncol <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimate model with HRK</span></span></span>
<span class="r-in"><span><span class="co"># note: we are cheating here and use the true disturbances!</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">=</span> <span class="fu">est_arma_hrk</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, <span class="va">data</span><span class="op">$</span><span class="va">u</span>, <span class="va">tmpl</span>,</span></span>
<span class="r-in"><span>                   trace <span class="op">=</span> <span class="cn">FALSE</span>, maxit <span class="op">=</span> <span class="fl">1</span>, mean_estimate <span class="op">=</span> <span class="st">'sample.mean'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">y.mean</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9511495 1.9436019 2.8487408</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ARMA model [3,3] with orders p = 1 and q = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AR polynomial a(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]  [,3]   z^1 [,1]        [,2]         [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0     0  0.6687489 -0.12600713 -0.154716557</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1     0  0.1944165 -0.04965131  0.057462781</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]        0     0     1 -0.3418481  0.50977514  0.007750021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MA polynomial b(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]  [,3]    z^1 [,1]        [,2]        [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0     0  0.05047286 -0.31806802  0.52077685</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1     0 -0.21348959 -0.01193928  0.04368415</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]        0     0     1 -0.45130821  0.70739668 -0.11303414</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Left square root of noise covariance Sigma:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            u[1]       u[2]    u[3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[1]  0.9644771 0.00000000 0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[2]  0.1932537 0.98300427 0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[3] -0.4325050 0.06192851 1.05045</span>
<span class="r-in"><span><span class="co"># ll() returns the same logLik value. However, we have to demean the data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">ll</span>, <span class="fu"><a href="ll.html">ll</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">model</span>, <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, center <span class="op">=</span> <span class="va">out</span><span class="op">$</span><span class="va">y.mean</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     <span class="st">'conditional'</span>, skip <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimate the model with HRK</span></span></span>
<span class="r-in"><span><span class="co"># use the residuals of a long AR model as estimates for the noise</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">=</span> <span class="fu">est_arma_hrk</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, e <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">tmpl</span>,</span></span>
<span class="r-in"><span>                   maxit <span class="op">=</span> <span class="fl">10</span>, mean_estimate <span class="op">=</span> <span class="st">'intercept'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HRK estimation of ARMA model: m=3, n.obs=200, p=1, q=1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial AR estimate of noise p.max=7, p=2, ll=-4.235502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter |th - th0|  n.val      MSE       ll </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1      1.051    197    3.200   -4.235  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2      0.135    199    3.220   -4.249  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3      0.081    199    3.223   -4.251  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4      0.048    199    3.220   -4.250  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5      0.035    199    3.222   -4.251  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    6      0.022    199    3.221   -4.250  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    7      0.015    199    3.222   -4.250  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    8      0.010    199    3.221   -4.250  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    9      0.007    199    3.222   -4.250  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10      0.005    199    3.221   -4.250  </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">y.mean</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9537144 1.9386421 2.8536800</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ARMA model [3,3] with orders p = 1 and q = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AR polynomial a(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]  [,3]   z^1 [,1]         [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0     0  0.6740053 -0.261126479 -0.3217273</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1     0  0.1479565  0.008074719 -0.1286455</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]        0     0     1 -0.2984776  0.523115301  0.1643308</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MA polynomial b(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]  [,3]    z^1 [,1]        [,2]        [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0     0  0.05225048 -0.45689436  0.35600140</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1     0 -0.25603151  0.04533693 -0.14860902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]        0     0     1 -0.41217354  0.72060291  0.04411931</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Left square root of noise covariance Sigma:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            u[1]       u[2]     u[3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[1]  0.9625622 0.00000000 0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[2]  0.1902924 0.98177314 0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[3] -0.4307534 0.06340989 1.051195</span>
<span class="r-in"><span><span class="co"># ll() returns the same logLik value. However, we have to demean the data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">ll</span>, <span class="fu"><a href="ll.html">ll</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">model</span>, <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, center <span class="op">=</span> <span class="va">out</span><span class="op">$</span><span class="va">y.mean</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     <span class="st">'conditional'</span>, skip <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We may also use this procedure to estimate AR models #####################</span></span></span>
<span class="r-in"><span><span class="co"># where some coefficients are fixed = 0</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="https://bfunovits.github.io/rationalmatrices/reference/dbind.html" class="external-link">dbind</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="cn">NA_real_</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="op">]</span> <span class="op">=</span> <span class="fl">0</span> <span class="co"># all coefficient matrices are lower triangular, i.e.</span></span></span>
<span class="r-in"><span><span class="co"># y[2t] does not Granger cause y[1t]</span></span></span>
<span class="r-in"><span><span class="va">tmpl</span> <span class="op">=</span> <span class="fu"><a href="model_structures.html">model2template</a></span><span class="op">(</span><span class="fu"><a href="armamod.html">armamod</a></span><span class="op">(</span>sys <span class="op">=</span> <span class="fu"><a href="https://bfunovits.github.io/rationalmatrices/reference/lmfd.html" class="external-link">lmfd</a></span><span class="op">(</span>a<span class="op">=</span><span class="va">a</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                              sigma_L <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA_real_</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      sigma_L <span class="op">=</span> <span class="st">'chol'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="r_model.html">r_model</a></span><span class="op">(</span>template <span class="op">=</span> <span class="va">tmpl</span>, bpoles <span class="op">=</span> <span class="fl">1</span>, bzeroes <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">sigma_L</span><span class="op">)</span> <span class="op">=</span> <span class="fl">1</span> <span class="co"># scale the diagonal entries of sigma_L</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ARMA model [2,2] with orders p = 2 and q = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AR polynomial a(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]   z^1 [,1]      [,2]    z^2 [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0 -0.1836216 0.0000000 -0.04334075 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1  0.2345054 0.2220447 -0.54760618 0.04449801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MA polynomial b(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Left square root of noise covariance Sigma:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             u[1] u[2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[1]  1.00000000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[2] -0.07017046    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generate a sample with 200 observations</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="sim.html">sim</a></span><span class="op">(</span><span class="va">model</span>, n.obs <span class="op">=</span> <span class="fl">200</span>, n.burn_in <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimate model with HRK</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">=</span> <span class="fu">est_arma_hrk</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, <span class="cn">NULL</span>, <span class="va">tmpl</span>,</span></span>
<span class="r-in"><span>                   trace <span class="op">=</span> <span class="cn">FALSE</span>, maxit <span class="op">=</span> <span class="fl">1</span>, mean_estimate <span class="op">=</span> <span class="st">'zero'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">y.mean</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 0</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ARMA model [2,2] with orders p = 2 and q = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AR polynomial a(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]   z^1 [,1]    [,2]    z^2 [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0 -0.1045799 0.00000 -0.04138278 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1  0.3202084 0.22883 -0.58485638 0.09887707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MA polynomial b(z):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      z^0 [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]        0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Left square root of noise covariance Sigma:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             u[1]      u[2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[1]  0.91829065 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u[2] -0.04809834 0.9383795</span>
<span class="r-in"><span><span class="co"># ll() returns the same logLik value. However, we have to demean the data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">ll</span>, <span class="fu"><a href="ll.html">ll</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">model</span>, <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, center <span class="op">=</span> <span class="va">out</span><span class="op">$</span><span class="va">y.mean</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     <span class="st">'conditional'</span>, skip <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># reset the "seed"</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://scholar.google.com/citations?user=-Ytb9BYAAAAJ" class="external-link">Wolfgang Scherrer</a>, <a href="https://ch.linkedin.com/in/bernd-funovits-phd-cfa-a8215016" class="external-link">Bernd Funovits</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

