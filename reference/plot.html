<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot Methods — plot methods • RLDM</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot Methods — plot methods"><meta name="description" content="Plot methods for impulse response functions (impresp() objects),
autocovariance functions (autocov() objects),
frequency response functions (freqresp() objects) and
spectral densities (spectrald() objects)."><meta property="og:description" content="Plot methods for impulse response functions (impresp() objects),
autocovariance functions (autocov() objects),
frequency response functions (freqresp() objects) and
spectral densities (spectrald() objects)."><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RLDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9006</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/0_getting_started.html">Getting Started with RLDM</a></li>
    <li><a class="dropdown-item" href="../articles/1_case_study.html">Case Study: Economic Data Analysis with RLDM</a></li>
    <li><a class="dropdown-item" href="../articles/2_technical_reference.html">Technical Reference: RLDM Classes and Methods</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bfunovits/RLDM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot Methods</h1>

      <div class="d-none name"><code>plot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plot methods for impulse response functions (<code><a href="impresp.html">impresp()</a></code> objects),
autocovariance functions (<code><a href="autocov.html">autocov()</a></code> objects),
frequency response functions (<code><a href="freqresp.html">freqresp()</a></code> objects) and
spectral densities (<code><a href="spectrald.html">spectrald()</a></code> objects).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'impresp'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  x_list <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"global"</span>, <span class="st">"column"</span>, <span class="st">"subfig"</span><span class="op">)</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"row"</span>, <span class="st">"subfig"</span>, <span class="st">"global"</span><span class="op">)</span>,</span>
<span>  main <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  xlab <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  ylab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subfigure_main <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  parse_subfigure_main <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gray"</span>, <span class="st">"bw"</span>, <span class="st">"bw2"</span>, <span class="st">"colored"</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>  lty <span class="op">=</span> <span class="st">"solid"</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  cex.points <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bg.points <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  legend <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legend_args <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'autocov'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  x_list <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"global"</span>, <span class="st">"column"</span>, <span class="st">"subfig"</span><span class="op">)</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"row"</span>, <span class="st">"subfig"</span>, <span class="st">"global"</span><span class="op">)</span>,</span>
<span>  main <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  xlab <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  ylab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subfigure_main <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  parse_subfigure_main <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gray"</span>, <span class="st">"bw"</span>, <span class="st">"bw2"</span>, <span class="st">"colored"</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>  lty <span class="op">=</span> <span class="st">"solid"</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  cex.points <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bg.points <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  legend <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legend_args <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'freqresp'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  x_list <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sampling_rate <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">""</span>,</span>
<span>  which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gain"</span>, <span class="st">"phase"</span>, <span class="st">"nyquist"</span><span class="op">)</span>,</span>
<span>  xlim <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  ylim <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  log <span class="op">=</span> <span class="st">""</span>,</span>
<span>  main <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  xlab <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  ylab <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  subfigure_main <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  parse_subfigure_main <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gray"</span>, <span class="st">"bw"</span>, <span class="st">"bw2"</span>, <span class="st">"colored"</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>  lty <span class="op">=</span> <span class="st">"solid"</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  cex.points <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bg.points <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  legend <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legend_args <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'spectrald'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  x_list <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sampling_rate <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">""</span>,</span>
<span>  which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"modulus"</span>, <span class="st">"phase"</span>, <span class="st">"coherence"</span><span class="op">)</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span> <span class="op">*</span> <span class="va">sampling_rate</span>,</span>
<span>  ylim <span class="op">=</span> <span class="st">"row"</span>,</span>
<span>  log <span class="op">=</span> <span class="st">""</span>,</span>
<span>  main <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  xlab <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  ylab <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  subfigure_main <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  parse_subfigure_main <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gray"</span>, <span class="st">"bw"</span>, <span class="st">"bw2"</span>, <span class="st">"colored"</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>  lty <span class="op">=</span> <span class="st">"solid"</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  cex.points <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bg.points <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  legend <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legend_args <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p><code><a href="impresp.html">impresp()</a></code>, <code><a href="autocov.html">autocov()</a></code>, <code><a href="freqresp.html">freqresp()</a></code> or
<code><a href="spectrald.html">spectrald()</a></code>  object.</p></dd>


<dt id="arg-x-list">x_list<a class="anchor" aria-label="anchor" href="#arg-x-list"></a></dt>
<dd><p>(optional) list of additional objects (of the same class as "<code>x</code>").</p></dd>


<dt id="arg-xlim-ylim">xlim, ylim<a class="anchor" aria-label="anchor" href="#arg-xlim-ylim"></a></dt>
<dd><p>determine the axis limits of the subfigures.
E.g. <code>xlim = 'column'</code> means that all subfigures in a column
use the same x-axis limits. Analogously <code>y = 'row'</code> implies
that the subfigures in a row share the same limits for the y-axis.
<br>
For the "<code>freqresp</code>" and "<code>spectrald</code>" plots the parameter
<code>xlim</code> may also be a numeric 2-dimensional vector <code>xlim = c(x1,x2)</code>.
In this case all sub-figures use the given limits for the x-axis.
Furthermore the limits for the y-axis are computed based on the
corresponding data subset. This option may be used to "zoom"
into a certain range of frequencies.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>not used.</p></dd>


<dt id="arg-sampling-rate">sampling_rate<a class="anchor" aria-label="anchor" href="#arg-sampling-rate"></a></dt>
<dd><p>(number) sampling rate.</p></dd>


<dt id="arg-unit">unit<a class="anchor" aria-label="anchor" href="#arg-unit"></a></dt>
<dd><p>(character string) time or frequency unit.</p></dd>


<dt id="arg-which">which<a class="anchor" aria-label="anchor" href="#arg-which"></a></dt>
<dd><p>(character string) what to plot. This parameter is only used
for plotting frequency response objects and spectral densities.
See details below.</p></dd>


<dt id="arg-log">log<a class="anchor" aria-label="anchor" href="#arg-log"></a></dt>
<dd><p>a character string which contains "x" if the x axis is to be logarithmic,
"y" if the y axis is to be logarithmic and "xy" or "yx" if both axes
are to be logarithmic.  This parameter is only used
for plotting frequency response objects and spectral densities.
Note that a logarithmic y-axis only makes sense when
plotting the moduli of the frequency response or the spectral density.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The plot methods return (invisibly) a "<code><a href="https://rdrr.io/r/base/function.html" class="external-link">closure()</a></code>", <code>subfig</code> say, which may be used to
add additional graphic elements to the subfigures. The call <code>opar = subfig(i,j)</code>
creates a new (sub) plot at the (i,j)-th position with suitable margins and
axis limits. See the examples below.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If <code>x</code> is an \((m,n)\) dimensional object then the plot is divided into an
\((m,n)\) array of subfigures. In each each of the subfigures the respective
\((i,j)\)-th element of the object <code>x</code> is displayed. The methods allow
simultaneous plotting of several objects, by passing a list <code>x_list</code>
with additional objects to the procedure. In the following we assume that
<code>x_list</code> contains \(k-1\) objects, i.e. in total \(k\) objects
are to be plotted.</p>
<p>The parameter "<code>xlim</code>" determines the x-limits of the subfigures:
<br><code>xlim='global'</code> uses the same x-limits for all subfigures (the limits are
determined from the data). In the case of frequency response or spectral density
objects one may also pass a two-dimensional vector <code>xlim = c(x1,x2)</code> to
the plot method. In this case all subfigures use these values as common x-limits.
<br><code>xlim='column'</code> means that all sub figures in a "column" have
the same x-limits. The limits are determined from data.
Finally <code>xlim='subfigure'</code> means that each subfigure gets its own
x-limits (determined from data).</p>
<p>Quite analogously the parameter <code>ylim</code> determines the limits for the y-axes.
(Just replace <code>'column'</code> by <code>'row'</code>).</p>
<p>The plot methods have quite a number of optional design parameters. In most cases
these parameters are interpreted as follows.
<code>NA</code> values mean that the methods use some suitable defaults.
E.g. the labels for the x- and y-axis are chosen according to the class of the
object(s) to be plotted and the parameter "<code>which</code>".
<code>NULL</code> values for the (optional) parameters mean that the respective graphic element is omitted.
E.g. <code>subfigure_main = NULL</code> skips the titles for the subfigures.</p>
<p>The titles for the (m,n) subfigures are determined by the parameter <code>subfigure_main</code>.
One may pass an \((m,n)\) character matrix or a scalar character (string) to the procedure.
If <code>subfigure_main</code> is a scalar (character string) then the procedures creates
the respective titles by replacing the "place holders" <code>i_</code> and <code>j_</code> with the
respective row and column number. See the examples below.</p>
<p>The "style" parameters <code>col, type, ..., bg.points</code> determine the appearance of the
"lines" for each of the <code>k</code> objects. (If necessary these values are "recycled".)
See also <code><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">graphics::lines()</a></code> and <code><a href="https://rdrr.io/r/graphics/points.html" class="external-link">graphics::points()</a></code> for a
more detailed explanation of these parameters.</p>
<p>If more than one object is to be plotted (the optional parameter <code>x_list</code> is not empty)
then a suitable legend may be added with the parameters <code>legend</code> and
<code>legend_args</code>. Note that <code>legend</code> should be a character (or expression) vector of
length <code>k</code>.</p>
<p>The parameter "<code>which</code>" determines what to plot in the case of
"<code>freqresp</code>" or "<code>spectrald</code>" objects.</p><dl><dt>gain,modulus</dt>
<dd><p>plot the moduli <code>abs(x[i,j])</code> versus frequencies.</p></dd>

<dt>phase</dt>
<dd><p>plot the arguments <code>Arg(x[i,j])</code> versus frequencies.</p></dd>

<dt>nyquist</dt>
<dd><p>plot the imaginary part <code>Im(x[i,j])</code> versus the real part <code>Re(x[i,j])</code>.</p></dd>

<dt>coherence</dt>
<dd><p>plot the <em>coherence</em>. This plot is somewhat special.
The "coherence matrix" is symmetric and and the diagonal entries are
are equal to one (for all frequencies). Therefore the entries on and below the
diagonal contain no additional information.
For this reason the subfigures above the diagonal display the coherence,
the subfigures below show the "scaled arguments" <code>Arg(x[i,j])/(2*pi)+0.5</code>
and the subfigures on the diagonal display the scaled auto spectra of the
\(m\) component processes.</p></dd>


</dl><p>These plot methods use the internal helper function <code>rationalmatrices::plot_3D()</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1995</span><span class="op">)</span>  <span class="co"># set seed to get reproducible results</span></span></span>
<span class="r-in"><span><span class="va">n.obs</span> <span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="fl">8</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">=</span> <span class="fl">3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generate a random, stable and minimum phase state space model</span></span></span>
<span class="r-in"><span><span class="co"># for a bivariate process (x[t], y[t])</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="test_stspmod.html">test_stspmod</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m</span>,<span class="va">m</span><span class="op">)</span>, s <span class="op">=</span> <span class="va">s</span>, bpoles <span class="op">=</span> <span class="fl">1</span>, bzeroes <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="va">names</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'x[t]'</span>, <span class="st">'y[t]'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulate data</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="sim.html">sim</a></span><span class="op">(</span><span class="va">model</span>, n.obs <span class="op">=</span> <span class="va">n.obs</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### plot impulse response</span></span></span>
<span class="r-in"><span><span class="co"># overlay three different "orthogonalization" schemes</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="impresp.html">impresp</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="impresp.html">impresp</a></span><span class="op">(</span><span class="va">model</span>, H <span class="op">=</span> <span class="st">'eigen'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          <span class="fu"><a href="impresp.html">impresp</a></span><span class="op">(</span><span class="va">model</span>, H <span class="op">=</span> <span class="st">'chol'</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'none'</span>,<span class="st">'chol'</span>,<span class="st">'eigen'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     legend_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'orthogonalization'</span>, fill <span class="op">=</span> <span class="cn">NA</span>, border <span class="op">=</span> <span class="cn">NA</span>, bty <span class="op">=</span> <span class="st">'n'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     style <span class="op">=</span> <span class="st">'colored'</span>, ylim <span class="op">=</span> <span class="st">'subfig'</span>, xlab <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### plot partial autocorrelation function</span></span></span>
<span class="r-in"><span><span class="co"># overlay with the corresponding sample partial ACF</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>lend <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># in order to get a "barplot"</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="autocov.html">autocov</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, lag.max <span class="op">=</span> <span class="fl">12</span>, type <span class="op">=</span> <span class="st">'partial'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="autocov.html">autocov</a></span><span class="op">(</span><span class="va">model</span>, lag.max <span class="op">=</span> <span class="fl">12</span>, type <span class="op">=</span> <span class="st">'partial'</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     subfigure_main <span class="op">=</span> <span class="st">'delta[i_*j_](k)'</span>, parse_subfigure_main <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>     style <span class="op">=</span> <span class="st">'bw'</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'h'</span>,<span class="st">'l'</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">19</span>, lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'sample'</span>, <span class="st">'true'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>lend <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># reset 'lend=0'</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># frequency response of the model</span></span></span>
<span class="r-in"><span><span class="va">n.f</span> <span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="fl">11</span></span></span>
<span class="r-in"><span><span class="va">frr</span> <span class="op">=</span> <span class="fu"><a href="freqresp.html">freqresp</a></span><span class="op">(</span><span class="va">model</span>, n.f <span class="op">=</span> <span class="va">n.f</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### plot "gain"</span></span></span>
<span class="r-in"><span><span class="va">subfig</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">frr</span>, which <span class="op">=</span> <span class="st">'gain'</span>,</span></span>
<span class="r-in"><span>              sampling_rate <span class="op">=</span> <span class="fl">60</span>, unit <span class="op">=</span> <span class="st">'Hz'</span>,</span></span>
<span class="r-in"><span>              ylim <span class="op">=</span> <span class="st">'row'</span>, log <span class="op">=</span> <span class="st">'y'</span>,</span></span>
<span class="r-in"><span>              subfigure_main <span class="op">=</span> <span class="st">'k[i_*j_](lambda)'</span>, parse_subfigure_main <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># mark the frequencies with the max gain!</span></span></span>
<span class="r-in"><span><span class="va">junk</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="va">frr</span><span class="op">$</span><span class="va">frr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">i_max</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Mod</a></span><span class="op">(</span><span class="va">junk</span><span class="op">)</span>, MARGIN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="va">which.max</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">f_max</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">60</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">n.f</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">n.f</span><span class="op">)</span><span class="op">[</span><span class="va">i_max</span><span class="op">]</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu">subfig</span><span class="op">(</span><span class="va">i</span>,<span class="va">j</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">f_max</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">'steelblue'</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="plot-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### create a "Nyquist" plot of the frequency response</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">frr</span>, which <span class="op">=</span> <span class="st">'nyquist'</span>,</span></span>
<span class="r-in"><span>     xlim <span class="op">=</span> <span class="st">'subfig'</span>, ylim <span class="op">=</span> <span class="st">'subfig'</span>,</span></span>
<span class="r-in"><span>     subfigure_main <span class="op">=</span> <span class="st">'k[i_*j_](lambda)'</span>, parse_subfigure_main <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compute spectral density</span></span></span>
<span class="r-in"><span><span class="va">spd</span> <span class="op">=</span> <span class="fu"><a href="spectrald.html">spectrald</a></span><span class="op">(</span><span class="va">model</span>, n.f <span class="op">=</span> <span class="fl">256</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### plot the coherence</span></span></span>
<span class="r-in"><span><span class="co"># the subfigure above the diagonal shows the coherenec between</span></span></span>
<span class="r-in"><span><span class="co"># the two component proceses x[t] and y[t]</span></span></span>
<span class="r-in"><span><span class="co"># the sub figures on the diagonal show the scaled autospectra</span></span></span>
<span class="r-in"><span><span class="co"># of the two component processes x[t] and y[t].</span></span></span>
<span class="r-in"><span><span class="co"># and the subfigure below the diagonal shows the</span></span></span>
<span class="r-in"><span><span class="co"># phase/argument of the cross spectral density between the</span></span></span>
<span class="r-in"><span><span class="co"># two component processes x[t] and y[t]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spd</span>, sampling_rate <span class="op">=</span> <span class="fl">60</span>, unit<span class="op">=</span><span class="st">"Hz"</span>,</span></span>
<span class="r-in"><span>     main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">spectral</span><span class="op">~</span><span class="va">density</span><span class="op">~</span><span class="op">~</span><span class="va">Gamma</span><span class="op">[</span><span class="va">i</span><span class="op">*</span><span class="va">j</span><span class="op">]</span> <span class="op">==</span> <span class="va">kappa</span><span class="op">[</span><span class="va">i</span><span class="op">*</span><span class="va">j</span><span class="op">]</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">i</span><span class="op">*</span><span class="va">Phi</span><span class="op">[</span><span class="va">i</span><span class="op">*</span><span class="va">j</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     which <span class="op">=</span> <span class="st">'coherence'</span>,</span></span>
<span class="r-in"><span>     style <span class="op">=</span> <span class="st">'bw'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># periodogram</span></span></span>
<span class="r-in"><span><span class="va">per</span> <span class="op">=</span> <span class="fu"><a href="spectrald.html">spectrald</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># smoothed periodogram</span></span></span>
<span class="r-in"><span><span class="va">sacf</span> <span class="op">=</span> <span class="fu"><a href="autocov.html">autocov</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, lag.max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n.obs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">per2</span> <span class="op">=</span> <span class="fu"><a href="spectrald.html">spectrald</a></span><span class="op">(</span><span class="va">sacf</span>, n.f <span class="op">=</span> <span class="fl">256</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### make a plot of the absolute value of the spectral density,</span></span></span>
<span class="r-in"><span><span class="co"># of the periodogram and the smoothed periogram.</span></span></span>
<span class="r-in"><span><span class="co"># with a logarithmic y-axis</span></span></span>
<span class="r-in"><span><span class="co"># skip zero frequency, since the periodogram is zero at lambda=0</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spd</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">per</span>, <span class="va">per2</span><span class="op">)</span>, sampling_rate <span class="op">=</span> <span class="fl">12</span>, unit <span class="op">=</span> <span class="st">'/year'</span>, which <span class="op">=</span> <span class="st">'modulus'</span>,</span></span>
<span class="r-in"><span>     log <span class="op">=</span> <span class="st">'y'</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n.obs</span>, <span class="fl">0.5</span><span class="op">)</span> <span class="op">*</span> <span class="fl">12</span>,  <span class="co"># skip zero frequency</span></span></span>
<span class="r-in"><span>     legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'true'</span>,<span class="st">'periodogram'</span>, <span class="st">'smoothed per.'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     legend_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>bty <span class="op">=</span> <span class="st">'n'</span>, col <span class="op">=</span> <span class="cn">NA</span>, lty <span class="op">=</span> <span class="cn">NA</span>, pch <span class="op">=</span> <span class="cn">NA</span>, lwd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     style <span class="op">=</span> <span class="st">'colored'</span>, ylim <span class="op">=</span> <span class="st">'subfig'</span>,</span></span>
<span class="r-in"><span>     subfigure_main <span class="op">=</span> <span class="st">'kappa[i_*j_] == group("|", Gamma[i_*j_], "|")'</span>,</span></span>
<span class="r-in"><span>     parse_subfigure_main <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'red'</span>, <span class="st">'black'</span>, <span class="st">'blue'</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'o'</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">19</span>, <span class="cn">NA</span><span class="op">)</span>, cex.points <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="co"># reset seed</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://scholar.google.com/citations?user=-Ytb9BYAAAAJ" class="external-link">Wolfgang Scherrer</a>, <a href="https://ch.linkedin.com/in/bernd-funovits-phd-cfa-a8215016" class="external-link">Bernd Funovits</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

