<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Residuals of a statespace system — residuals_STSP_cpp • RLDM</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Residuals of a statespace system — residuals_STSP_cpp"><meta name="description" content="This internal helper function computes the residuals
(and the directional derivatives of the residuals)
for a statespace system of the form
$$a_{t+1} = A a_t + B u_t, \; y_t = C a_t + D u_t$$
The system must be square and non-empty, i.e. \(m=n&amp;gt;0\)."><meta property="og:description" content="This internal helper function computes the residuals
(and the directional derivatives of the residuals)
for a statespace system of the form
$$a_{t+1} = A a_t + B u_t, \; y_t = C a_t + D u_t$$
The system must be square and non-empty, i.e. \(m=n&amp;gt;0\)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RLDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9006</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/0_getting_started.html">Getting Started with RLDM</a></li>
    <li><a class="dropdown-item" href="../articles/1_case_study.html">Case Study: Economic Data Analysis with RLDM</a></li>
    <li><a class="dropdown-item" href="../articles/2_technical_reference.html">Technical Reference: RLDM Classes and Methods</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bfunovits/RLDM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Residuals of a statespace system</h1>

      <div class="d-none name"><code>residuals_STSP_cpp.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This internal helper function computes the residuals
(and the directional derivatives of the residuals)
for a statespace system of the form
$$a_{t+1} = A a_t + B u_t, \; y_t = C a_t + D u_t$$
The system must be square and non-empty, i.e. \(m=n&gt;0\).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">residuals_STSP_cpp</span><span class="op">(</span><span class="va">A</span>, <span class="va">B</span>, <span class="va">C</span>, <span class="va">D</span>, <span class="va">y</span>, <span class="va">a</span>, <span class="va">u</span>, <span class="va">dPI</span>, <span class="va">dU</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-a">A<a class="anchor" aria-label="anchor" href="#arg-a"></a></dt>
<dd><p>\((s,s)\) matrix.</p></dd>


<dt id="arg-b">B<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>\((s,m)\) matrix.</p></dd>


<dt id="arg-c">C<a class="anchor" aria-label="anchor" href="#arg-c"></a></dt>
<dd><p>\((m,s)\) matrix.</p></dd>


<dt id="arg-d">D<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>\((m,m)\) matrix, must be regular.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>\((m,N)\) matrix with the outputs: \((y_1,y_2,\ldots,y_N)\).</p></dd>


<dt id="arg-a">a<a class="anchor" aria-label="anchor" href="#arg-a"></a></dt>
<dd><p>\((s,N+1)\) matrix. This matrix is overwritten with the (computed) states:
\((a_1,a_2,\ldots,a_N,a_{N+1})\).
On input <code>a[,1]</code> must hold the initial state \(a_1\).</p></dd>


<dt id="arg-u">u<a class="anchor" aria-label="anchor" href="#arg-u"></a></dt>
<dd><p>\((m,N)\) matrix. This matrix is overwritten with (computed) residuals:
\((u_1,u_2,\ldots,u_N)\).</p></dd>


<dt id="arg-dpi">dPI<a class="anchor" aria-label="anchor" href="#arg-dpi"></a></dt>
<dd><p>\(((m+s)^2,K)\) matrix.</p></dd>


<dt id="arg-du">dU<a class="anchor" aria-label="anchor" href="#arg-du"></a></dt>
<dd><p>\((mN,K)\) matrix or \((0,0)\) matrix. This matrix is overwritten with the
directional derivatives of the residuals. However, if
the matrix is empty then no derivatives are computed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>This RcppArmadillo implementation returns <code>NULL</code> but <b>overwrites</b> the input
arguments <code>a</code>, <code>u</code> and <code>dU</code>!</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Use this procedure with care!</p><ul><li><p>The procedure does <b>not</b> check the input arguments.</p></li>
<li><p>The procedure <b>overwrites</b> the input arguments
<code>a</code>, <code>u</code> and <code>dU</code>.</p></li>
<li><p>The data matrices are organized columnwise (to avoid memory shuffling)!</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="outputs_ARMA_cpp.html">outputs_ARMA_cpp</a></code>, <code><a href="residuals_ARMA_cpp.html">residuals_ARMA_cpp</a></code>,  <code><a href="cll_theta_ARMA_cpp.html">cll_theta_ARMA_cpp</a></code>,
<code><a href="outputs_STSP_cpp.html">outputs_STSP_cpp</a></code>, <code>residuals_STSP_cpp</code>,  <code><a href="cll_theta_STSP_cpp.html">cll_theta_STSP_cpp</a></code> and
<code><a href="solve_de.html">solve_de</a></code>, <code><a href="solve_de.html">solve_inverse_de</a></code> and <code><a href="ll.html">ll</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># generate a random statespace model (3 outputs, 3 inputs and 4 states)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">=</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="test_stspmod.html">test_stspmod</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">m</span><span class="op">)</span>, s <span class="op">=</span> <span class="va">s</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generate random noise sequence (sample size N = 10)</span></span></span>
<span class="r-in"><span><span class="va">n.obs</span> <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">u</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n.obs</span><span class="op">*</span><span class="va">m</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">m</span>, ncol <span class="op">=</span> <span class="va">n.obs</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generate matrix for the state sequence</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">s</span>, ncol <span class="op">=</span> <span class="va">n.obs</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="co"># random initial state a[1]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generate matrix for the outputs</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">m</span>, ncol <span class="op">=</span> <span class="va">n.obs</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compute outputs and states</span></span></span>
<span class="r-in"><span><span class="fu"><a href="outputs_STSP_cpp.html">outputs_STSP_cpp</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">sys</span><span class="op">$</span><span class="va">A</span>, <span class="va">model</span><span class="op">$</span><span class="va">sys</span><span class="op">$</span><span class="va">B</span>, <span class="va">model</span><span class="op">$</span><span class="va">sys</span><span class="op">$</span><span class="va">C</span>, <span class="va">model</span><span class="op">$</span><span class="va">sys</span><span class="op">$</span><span class="va">D</span>, <span class="va">u</span>, <span class="va">a</span>, <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># recompute the states and disturbances/residuals from the given outputs:</span></span></span>
<span class="r-in"><span><span class="va">uu</span> <span class="op">=</span> <span class="va">u</span> <span class="op">+</span> <span class="fl">0</span> <span class="co"># "deep copy" of the disturbances</span></span></span>
<span class="r-in"><span><span class="va">aa</span> <span class="op">=</span> <span class="va">a</span> <span class="op">+</span> <span class="fl">0</span> <span class="co"># and the states</span></span></span>
<span class="r-in"><span><span class="va">aa</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="va">n.obs</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span> <span class="co"># clear all states a[t], t &gt; 1</span></span></span>
<span class="r-in"><span><span class="fu">residuals_STSP_cpp</span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">sys</span><span class="op">$</span><span class="va">A</span>, <span class="va">model</span><span class="op">$</span><span class="va">sys</span><span class="op">$</span><span class="va">B</span>, <span class="va">model</span><span class="op">$</span><span class="va">sys</span><span class="op">$</span><span class="va">C</span>, <span class="va">model</span><span class="op">$</span><span class="va">sys</span><span class="op">$</span><span class="va">D</span>,</span></span>
<span class="r-in"><span>                   <span class="va">y</span>, <span class="va">aa</span>, <span class="va">uu</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">u</span>, <span class="va">uu</span><span class="op">)</span> <span class="co"># check</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">aa</span><span class="op">)</span> <span class="co"># check</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compute directional derivatives of residuals</span></span></span>
<span class="r-in"><span><span class="va">dPI</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="op">(</span><span class="va">m</span><span class="op">+</span><span class="va">s</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dU</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">n.obs</span><span class="op">*</span><span class="va">m</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dPI</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">residuals_STSP_cpp</span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">sys</span><span class="op">$</span><span class="va">A</span>, <span class="va">model</span><span class="op">$</span><span class="va">sys</span><span class="op">$</span><span class="va">B</span>, <span class="va">model</span><span class="op">$</span><span class="va">sys</span><span class="op">$</span><span class="va">C</span>, <span class="va">model</span><span class="op">$</span><span class="va">sys</span><span class="op">$</span><span class="va">D</span>,</span></span>
<span class="r-in"><span>                   <span class="va">y</span>, <span class="va">aa</span>, <span class="va">uu</span>, <span class="va">dPI</span>, <span class="va">dU</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># check the directional derivatives</span></span></span>
<span class="r-in"><span><span class="va">eps</span> <span class="op">=</span> <span class="fl">1e-8</span></span></span>
<span class="r-in"><span><span class="va">dU_num</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">m</span><span class="op">*</span><span class="va">n.obs</span>, ncol <span class="op">=</span> <span class="op">(</span><span class="va">m</span><span class="op">+</span><span class="va">s</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dPI</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="op">(</span><span class="va">m</span><span class="op">+</span><span class="va">s</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="op">(</span><span class="va">m</span><span class="op">+</span><span class="va">s</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="op">(</span><span class="va">m</span><span class="op">+</span><span class="va">s</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">dPI</span><span class="op">[</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span>  <span class="va">dPI</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">=</span> <span class="va">eps</span></span></span>
<span class="r-in"><span>  <span class="va">uu</span> <span class="op">=</span> <span class="va">u</span> <span class="op">+</span> <span class="fl">0</span> <span class="co"># "deep copy" of the disturbances</span></span></span>
<span class="r-in"><span>  <span class="va">aa</span> <span class="op">=</span> <span class="va">a</span> <span class="op">+</span> <span class="fl">0</span> <span class="co"># and the states</span></span></span>
<span class="r-in"><span>  <span class="fu">residuals_STSP_cpp</span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">sys</span><span class="op">$</span><span class="va">A</span> <span class="op">+</span> <span class="va">dPI</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">s</span>,<span class="fl">1</span><span class="op">:</span><span class="va">s</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                     <span class="va">model</span><span class="op">$</span><span class="va">sys</span><span class="op">$</span><span class="va">B</span> <span class="op">+</span> <span class="va">dPI</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">s</span>,<span class="op">(</span><span class="va">s</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">s</span><span class="op">+</span><span class="va">m</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                     <span class="va">model</span><span class="op">$</span><span class="va">sys</span><span class="op">$</span><span class="va">C</span> <span class="op">+</span> <span class="va">dPI</span><span class="op">[</span><span class="op">(</span><span class="va">s</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">s</span><span class="op">+</span><span class="va">m</span><span class="op">)</span>,<span class="fl">1</span><span class="op">:</span><span class="va">s</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                     <span class="va">model</span><span class="op">$</span><span class="va">sys</span><span class="op">$</span><span class="va">D</span> <span class="op">+</span> <span class="va">dPI</span><span class="op">[</span><span class="op">(</span><span class="va">s</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">s</span><span class="op">+</span><span class="va">m</span><span class="op">)</span>,<span class="op">(</span><span class="va">s</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">s</span><span class="op">+</span><span class="va">m</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                     <span class="va">y</span>, <span class="va">aa</span>, <span class="va">uu</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">dU_num</span><span class="op">[</span>, <span class="va">k</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">uu</span> <span class="op">-</span> <span class="va">u</span> <span class="op">)</span><span class="op">/</span><span class="va">eps</span>  <span class="co"># num. approx. of the derivative in direction "dPI"</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co"># relative error of the numerical approximation</span></span></span>
<span class="r-in"><span><span class="va">junk</span> <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">dU</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">dU_num</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">junk</span><span class="op">[</span><span class="va">junk</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">dU_num</span> <span class="op">-</span> <span class="va">dU</span><span class="op">)</span><span class="op">/</span><span class="va">junk</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               [,1]         [,2]         [,3]         [,4]         [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.000000e+00 0.000000e+00 0.000000e+00 2.941371e-08 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 2.000000e+00 2.000000e+00 2.000000e+00 2.000000e+00 7.966167e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 1.323619e-07 4.931138e-08 7.895611e-08 7.092010e-08 1.182013e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 2.860996e-08 6.623199e-08 1.424939e-08 3.511900e-08 3.266407e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 1.426027e-08 4.170071e-09 1.774511e-08 1.000876e-07 8.327800e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 2.597297e-07 7.809321e-08 1.002004e-07 3.067129e-08 8.012674e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 4.528041e-08 1.009912e-08 5.938559e-07 1.857393e-08 3.196471e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 1.983580e-08 6.089617e-08 2.860093e-08 6.580872e-09 3.133063e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 1.293590e-08 1.871021e-08 3.898990e-08 2.508928e-08 1.542619e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 1.402666e-07 7.630924e-09 2.538018e-08 1.034221e-08 5.749908e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 5.870360e-08 2.326964e-08 2.378299e-07 3.835333e-08 2.851029e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 7.595212e-09 5.934009e-08 2.112861e-07 8.514201e-08 7.422990e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 5.850927e-09 1.800359e-08 1.631632e-07 4.842351e-08 2.264254e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 4.492940e-08 2.964343e-08 5.004095e-08 5.231009e-09 1.282689e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 4.678318e-08 1.263684e-09 4.169427e-08 1.858318e-08 1.288966e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 3.348001e-08 4.771560e-08 8.520807e-08 6.425257e-08 4.084121e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 3.895673e-08 3.600991e-09 1.161267e-07 6.058685e-08 4.826482e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 1.073978e-08 4.926595e-09 7.655653e-08 7.763141e-08 1.531761e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 1.225784e-08 7.823729e-09 8.285753e-08 1.313272e-09 6.366661e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 1.592796e-07 4.380687e-08 3.013109e-07 1.635318e-07 4.559093e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               [,6]         [,7]         [,8]         [,9]        [,10]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.000000e+00 0.000000e+00 0.000000e+00 2.881805e-11 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 2.000000e+00 2.000000e+00 2.000000e+00 2.000000e+00 9.575519e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 7.248583e-08 2.542905e-08 4.453794e-08 1.017810e-06 1.061883e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 4.903917e-08 6.694412e-08 1.244401e-08 2.355255e-08 1.544267e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 2.019778e-08 2.071621e-08 2.973336e-08 8.743186e-09 4.768203e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 9.295473e-08 2.366466e-08 3.239653e-08 7.400954e-08 1.180308e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 7.118910e-08 2.709597e-08 4.968033e-08 4.629561e-08 5.862025e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 6.812220e-08 1.513280e-08 2.659318e-08 4.656004e-07 2.570852e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 4.691254e-08 2.487324e-08 3.229785e-08 8.654113e-08 1.438185e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 5.278518e-07 3.984327e-08 9.537111e-08 7.580142e-08 4.708178e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 5.984729e-08 4.789147e-09 2.081308e-07 6.792823e-08 2.116387e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 1.040074e-07 5.486722e-08 8.799054e-08 1.883671e-06 4.632073e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 2.516501e-08 3.463798e-08 2.307578e-08 7.955473e-08 8.916622e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 5.490995e-08 1.446921e-08 1.145018e-07 8.761998e-08 3.904314e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 1.946600e-08 2.108117e-08 1.388144e-07 2.871029e-08 1.242312e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 1.454118e-08 8.413752e-08 1.162556e-06 1.464336e-07 1.657342e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 1.618968e-09 3.141052e-08 1.407113e-08 1.177947e-08 1.583229e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 2.201081e-09 1.716905e-08 1.418126e-07 7.582782e-08 9.129461e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 1.405383e-08 2.877418e-08 7.594477e-08 4.180131e-08 2.634832e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 4.087692e-08 2.663685e-08 2.806262e-07 2.033450e-07 3.609620e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,11]        [,12]        [,13]        [,14]        [,15]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.000000e+00 0.000000e+00 0.000000e+00 7.973343e-08 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 2.000000e+00 2.000000e+00 2.000000e+00 2.000000e+00 1.967356e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 2.282659e-07 3.152623e-07 1.536118e-07 1.250674e-06 1.505344e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 2.024364e-07 1.899799e-07 5.702262e-08 1.394162e-07 1.473690e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 1.228368e-07 6.532939e-08 5.442489e-08 2.712306e-08 2.269907e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 5.400837e-08 7.384711e-07 1.719048e-06 4.731884e-08 2.021468e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 4.161352e-08 1.563505e-07 1.451158e-07 5.036382e-08 2.316459e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 1.357749e-08 2.046310e-07 1.047868e-07 4.682246e-08 7.585794e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 2.950945e-08 1.565990e-08 1.094895e-06 2.876973e-08 5.200278e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 7.865839e-08 1.435089e-07 9.186137e-09 3.808663e-08 9.026538e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 4.614745e-08 5.411325e-08 2.656472e-08 9.751159e-08 2.108639e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 1.068125e-07 4.875514e-08 1.694566e-08 7.865030e-08 5.933020e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 3.262173e-08 6.448147e-09 1.710743e-08 8.214841e-10 3.744370e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 6.388941e-08 6.131166e-08 9.487218e-08 1.276395e-07 1.140067e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 2.099339e-10 2.274203e-08 1.794526e-07 7.871745e-08 6.501356e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 6.012462e-08 3.145856e-08 4.280834e-08 9.081650e-08 1.691237e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 6.176227e-09 1.425033e-08 5.625193e-08 2.130084e-08 1.171662e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 1.414073e-08 2.121395e-08 7.376648e-08 1.165911e-07 3.216307e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 1.483784e-08 4.373480e-09 1.400136e-07 5.380136e-08 3.071866e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 4.473260e-08 4.551741e-08 6.598846e-08 6.741088e-08 4.178792e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,16]        [,17]        [,18]        [,19]        [,20]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.000000e+00 0.000000e+00 0.000000e+00 4.121259e-10 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 2.000000e+00 2.000000e+00 2.000000e+00 2.000000e+00 1.365368e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 1.149996e-07 6.660417e-08 7.535072e-08 1.165491e-07 6.903567e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 6.966087e-09 7.317289e-08 2.369125e-08 1.822731e-07 2.569778e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 8.177752e-08 1.969069e-09 1.963408e-08 1.303733e-07 1.892513e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 3.601979e-08 1.308555e-06 2.124392e-08 3.402255e-06 4.344250e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 1.013590e-07 1.486348e-07 5.413576e-09 8.913106e-08 2.945288e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 8.436401e-08 2.821498e-07 3.390099e-08 2.415578e-07 2.861005e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 7.370434e-08 6.012152e-08 1.140294e-07 4.030284e-07 2.696684e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 2.192391e-07 1.288584e-07 6.449751e-07 6.725504e-11 2.650456e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 8.477519e-07 6.057641e-08 1.298200e-07 5.299816e-08 1.525460e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 5.197619e-08 1.543955e-07 1.527280e-07 4.943354e-08 8.432048e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 2.583723e-09 4.087525e-09 2.875900e-07 1.437610e-06 7.025837e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 2.198393e-07 7.541248e-08 1.006742e-08 1.267471e-07 3.850338e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 1.194423e-07 1.517430e-08 7.995441e-08 3.730760e-08 6.506659e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 8.079763e-07 1.038212e-07 1.012212e-07 1.585011e-05 3.111442e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 2.177500e-08 4.802020e-08 7.324602e-07 2.881011e-07 1.250368e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 2.097218e-07 2.055495e-08 1.026495e-07 1.661281e-06 5.218113e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 6.314225e-08 2.966080e-08 1.220640e-07 5.280561e-08 3.279978e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 1.581361e-08 9.941546e-08 1.367463e-06 1.819330e-07 2.649041e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,21]        [,22]        [,23]        [,24]        [,25]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.000000e+00 0.000000e+00 0.000000e+00 2.583826e-07 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 2.000000e+00 2.000000e+00 2.000000e+00 2.000000e+00 2.088507e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 3.001404e-07 1.460949e-07 2.266264e-07 2.995725e-08 5.397657e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 1.407299e-07 8.905564e-08 3.872526e-08 1.444178e-07 1.296238e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 1.922313e-10 9.062531e-08 9.259868e-08 7.114987e-07 2.204251e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 1.329972e-07 5.899715e-07 1.105610e-07 9.307232e-07 1.718560e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 4.841038e-07 3.721351e-08 2.863618e-07 6.797296e-07 4.109152e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 7.349757e-08 3.676666e-07 1.004935e-07 1.651943e-07 3.138052e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 4.548874e-09 8.922154e-08 1.021003e-07 2.204555e-07 2.202143e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 1.666730e-07 4.438526e-07 2.093011e-06 3.008767e-07 2.857587e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 2.899053e-06 1.138774e-07 2.706892e-06 6.203765e-07 8.938434e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 5.039889e-07 8.685609e-07 3.202163e-07 2.250761e-07 2.357651e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 2.462816e-08 1.223484e-07 2.041031e-06 2.134768e-06 3.414647e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 9.577582e-07 5.584082e-07 2.924082e-07 2.566201e-07 1.537374e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 3.189034e-07 2.240887e-07 1.185965e-06 6.288940e-07 1.240094e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 7.210762e-07 5.248541e-07 3.740927e-07 1.600956e-06 5.780689e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 8.982719e-07 2.539732e-07 2.332900e-06 1.440319e-06 2.200996e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 1.414907e-07 7.220807e-07 1.852326e-07 4.321425e-06 8.764079e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 2.915811e-07 2.275871e-07 7.848724e-07 9.723181e-07 2.566885e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 2.259479e-06 1.246954e-06 3.480474e-06 2.687053e-07 1.146239e-06</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://scholar.google.com/citations?user=-Ytb9BYAAAAJ" class="external-link">Wolfgang Scherrer</a>, <a href="https://ch.linkedin.com/in/bernd-funovits-phd-cfa-a8215016" class="external-link">Bernd Funovits</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

