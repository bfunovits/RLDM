<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Compute respectively estimate the autocovariance, autocorrelation or partial autocorrelation function of a stationary process."><title>Autocovariance, Autocorelation and Partial Autocorrelation Function — autocov • RLDM</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Autocovariance, Autocorelation and Partial Autocorrelation Function — autocov"><meta property="og:description" content="Compute respectively estimate the autocovariance, autocorrelation or partial autocorrelation function of a stationary process."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">RLDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9006</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a_RLDM.html">Rational Linear Dynamic Models (RLDM)</a>
    <a class="dropdown-item" href="../articles/b_RLDM_technicaldetails.html">Rational Linear Dynamic Models (RLDM): Technical Details</a>
    <a class="dropdown-item" href="../articles/c_hrk_stage3.html">Hannan-Rissanen-Kavalieris Estimation - Stage 3</a>
    <a class="dropdown-item" href="../articles/d_casestudy2.html">Case Study</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bfunovits/RLDM/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Autocovariance, Autocorelation and Partial Autocorrelation Function</h1>
      
      <div class="d-none name"><code>autocov.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute respectively estimate the autocovariance, autocorrelation or partial autocorrelation function of a stationary process.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">autocov</span><span class="op">(</span><span class="va">obj</span>, <span class="va">type</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">autocov</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"covariance"</span>, <span class="st">"correlation"</span>, <span class="st">"partial"</span><span class="op">)</span>,</span>
<span>  lag.max <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.action <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.fail</a></span>,</span>
<span>  demean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for autocov</span></span>
<span><span class="fu">autocov</span><span class="op">(</span><span class="va">obj</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"covariance"</span>, <span class="st">"correlation"</span>, <span class="st">"partial"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for armamod</span></span>
<span><span class="fu">autocov</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"covariance"</span>, <span class="st">"correlation"</span>, <span class="st">"partial"</span><span class="op">)</span>,</span>
<span>  lag.max <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for stspmod</span></span>
<span><span class="fu">autocov</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"covariance"</span>, <span class="st">"correlation"</span>, <span class="st">"partial"</span><span class="op">)</span>,</span>
<span>  lag.max <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>obj</dt>
<dd><p>either a <code><a href="armamod.html">armamod()</a></code>, <code><a href="stspmod.html">stspmod()</a></code>, <code>autocov()</code> object
or a "data" object.</p></dd>


<dt>type</dt>
<dd><p>character string giving the type of acf to be computed. Allowed values are
"covariance" (the default), "correlation", or "partial". Will be partially matched.
Note that the default value here is "covariance" whereas <code><a href="https://rdrr.io/r/stats/acf.html" class="external-link">stats::acf()</a></code>
uses "correlation" as default.</p></dd>


<dt>...</dt>
<dd><p>not used.</p></dd>


<dt>lag.max</dt>
<dd><p>(integer) maximum lag.</p></dd>


<dt>na.action</dt>
<dd><p>function to be called to handle missing values. <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">stats::na.pass()</a></code> can be used.</p></dd>


<dt>demean</dt>
<dd><p>logical. Should the covariances be about the sample means?</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>autocov</code> object, i.e. a list with slots</p>
<dl><dt>acf</dt>
<dd><p><code><a href="https://bfunovits.github.io/rationalmatrices/reference/pseries.html" class="external-link">rationalmatrices::pseries()</a></code> object, which stores the covariances (correlations).</p></dd>

<dt>type</dt>
<dd><p>character string which indicates the type of the ACF.</p></dd>

<dt>gamma</dt>
<dd><p>(m,m,lag.max+1) dimensional array which stores the autocovariance function.</p></dd>

<dt>names</dt>
<dd><p>(m)-dimensional character vector or NULL. This optional slot stores the names
for the components of the time series/process.</p></dd>

<dt>label</dt>
<dd><p>character string or NULL.</p></dd>

<dt>n.obs</dt>
<dd><p>integer or NULL. This slot stores the sample size.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The class of the input parameter "<code>obj</code>" determines the S3 method called and hence what is actually computed.</p>
<p><strong>Population ACF:</strong></p>
<p>If "<code>obj</code>" is an <code><a href="armamod.html">armamod()</a></code> or <code><a href="stspmod.html">stspmod()</a></code> object then <code>autocov(obj, ...)</code> computes the ACF of the corresponding stationary process.</p>
<p>Note however, that the function returns nonsense, if the model does not satisfy the <em>stability</em> condition.</p>
<p><strong>Change the type of an ACF:</strong></p>
<p>Calling <code>autocov(obj, type)</code>, where "<code>obj</code>" is an <code>autocov</code> object returns an ACF of the desired type.
E.g. if "<code>obj</code>" holds a partial autocorrelation function then <code>autocov(obj, type = 'covariance')</code> may be used to retrieve the corresponding autocovariance function.</p>
<p>This is possible since the <code>autocov</code> object stores the "original" autocovariances in a slot named <code>gamma</code>.</p>
<p><strong>Sample ACF:</strong></p>
<p>The default S3 method estimates the ACF from given data.
It assumes that "<code>obj</code>" is a univariate or multivariate numeric time series object,
a (numeric) data frame or a (numeric) vector, respectively matrix
and then simply calls the function <code><a href="https://rdrr.io/r/stats/acf.html" class="external-link">stats::acf()</a></code> in the <span class="pkg">stats</span> package to compute the sample autocovariance function.
If needed, then the corresponding sample autocorrelation, respectively sample partial autocorrelation function is computed (and returned).</p>
<p>The syntax is quite analogous to <code><a href="https://rdrr.io/r/stats/acf.html" class="external-link">stats::acf()</a></code>, so please consider the documentation of <code><a href="https://rdrr.io/r/stats/acf.html" class="external-link">stats::acf()</a></code> for more details.</p>
<p>Note that <span class="pkg">stats</span> stores autocovariance/autocorrelation functions as <code>(lag.max+1,m,m)</code> dimensional arrays, whereas <span class="pkg">RLDM</span> uses <code>(m,m,lag.max+1)</code> dimensional arrays.</p>
<p>The definition of partial autocorrelations used by <code><a href="https://rdrr.io/r/stats/acf.html" class="external-link">stats::acf()</a></code> differs from the definition used here, see e.g. (Reinsel 1997)
.
Furthermore <code><a href="https://rdrr.io/r/stats/acf.html" class="external-link">stats::acf()</a></code> skips the lag zero partial autocorrelation coefficient
and thus the pacf computed by  <code><a href="https://rdrr.io/r/stats/acf.html" class="external-link">stats::acf()</a></code> is (lag.max,n,n) dimensional.</p>
<p>The default choice for the number of lags is \(10*log10(N/m)\) where \(N\)
is the number of observations and \(m\) the number of series.
This number will be automatically limited to one less than the number
of observations in the series.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Reinsel GC (1997).
<em>Elements of Multivariate Time Series Analysis</em>.
Springer.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The autocovariance function of (V)ARMA processes may also be
computed by <code><a href="https://rdrr.io/r/stats/ARMAacf.html" class="external-link">stats::ARMAacf()</a></code> in the scalar case and by
<code>MTS::VARMAcov()</code> in the multivariate case (m &gt; 1).</p>
<p>As noted above the sample ACF is computed via the <code><a href="https://rdrr.io/r/stats/acf.html" class="external-link">stats::acf()</a></code> routine in the <span class="pkg">stats</span> package.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="stspmod.html">stspmod</a></span><span class="op">(</span>sys <span class="op">=</span> <span class="fu">stsp</span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.2</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">0.5</span><span class="op">)</span>, B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>, sigma_L <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'y1'</span>,<span class="st">'y2'</span><span class="op">)</span>, label <span class="op">=</span> <span class="st">'test model'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">=</span> <span class="fu">autocov</span><span class="op">(</span><span class="va">model</span>, lag.max<span class="op">=</span><span class="fl">10</span><span class="op">)</span>       <span class="co"># ACF</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">=</span> <span class="fu">autocov</span><span class="op">(</span><span class="va">model</span>, lag.max<span class="op">=</span><span class="fl">10</span>, type <span class="op">=</span> <span class="st">'correlation'</span><span class="op">)</span>  <span class="co"># autocorrelation function</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">=</span> <span class="fu">autocov</span><span class="op">(</span><span class="va">g</span>, type <span class="op">=</span> <span class="st">'correlation'</span><span class="op">)</span>                  <span class="co"># this gives the same result!</span></span></span>
<span class="r-in"><span><span class="va">c</span> <span class="op">=</span> <span class="fu">autocov</span><span class="op">(</span><span class="va">r</span>, type <span class="op">=</span> <span class="st">'partial'</span><span class="op">)</span>     <span class="co"># partial autocorrelation function</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># consider an equivalent VARMA model</span></span></span>
<span class="r-in"><span><span class="va">model2</span> <span class="op">=</span> <span class="fu">impresp2varma</span><span class="op">(</span><span class="fu">irf</span><span class="op">(</span><span class="va">model</span>, lag.max <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">model</span></span></span>
<span class="r-in"><span><span class="va">g2</span> <span class="op">=</span> <span class="fu">autocov</span><span class="op">(</span><span class="va">model2</span>, lag.max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">g</span>,<span class="va">g2</span><span class="op">)</span> <span class="co"># of course both return the same ACF</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">autocov</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">autocov</span><span class="op">(</span><span class="fu"><a href="stspmod.html">stspmod</a></span><span class="op">(</span><span class="fu">test_stsp</span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, s <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, sigma_L <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generate a random sample with 100 observations and 3 outputs/series.</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fl">3</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">100</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the covariance estimates are of course identical</span></span></span>
<span class="r-in"><span><span class="va">stats_acfobj</span> <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html" class="external-link">acf</a></span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="st">'covariance'</span>, demean <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rldm_acfobj</span>  <span class="op">=</span> <span class="fu">acf_estimate</span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="st">'covariance'</span>, demean <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/expect_equivalent.html" class="external-link">expect_equivalent</a></span><span class="op">(</span><span class="va">rldm_acfobj</span><span class="op">$</span><span class="va">gamma</span>, <span class="fu"><a href="https://rdrr.io/r/base/aperm.html" class="external-link">aperm</a></span><span class="op">(</span><span class="va">stats_acfobj</span><span class="op">$</span><span class="va">acf</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># also the correlation estimates are identical</span></span></span>
<span class="r-in"><span><span class="va">stats_acfobj</span> <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html" class="external-link">acf</a></span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="st">'correlation'</span>, demean <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rldm_acfobj</span>  <span class="op">=</span> <span class="fu">acf_estimate</span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="st">'correlation'</span>, demean <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/expect_equivalent.html" class="external-link">expect_equivalent</a></span><span class="op">(</span><span class="va">rldm_acfobj</span><span class="op">$</span><span class="va">gamma</span>, <span class="fu"><a href="https://rdrr.io/r/base/aperm.html" class="external-link">aperm</a></span><span class="op">(</span><span class="va">stats_acfobj</span><span class="op">$</span><span class="va">acf</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># However, the partial correlations dont match!</span></span></span>
<span class="r-in"><span><span class="va">stats_acfobj</span> <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html" class="external-link">acf</a></span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="st">'partial'</span>, demean <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rldm_acfobj</span>  <span class="op">=</span> <span class="fu">acf_estimate</span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="st">'partial'</span>, demean <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/expect_equivalent.html" class="external-link">expect_equivalent</a></span><span class="op">(</span><span class="va">rldm_acfobj</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span>,,<span class="op">-</span><span class="fl">1</span>,drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/aperm.html" class="external-link">aperm</a></span><span class="op">(</span><span class="va">stats_acfobj</span><span class="op">$</span><span class="va">acf</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://scholar.google.com/citations?user=-Ytb9BYAAAAJ" class="external-link">Wolfgang Scherrer</a>, <a href="https://ch.linkedin.com/in/bernd-funovits-phd-cfa-a8215016" class="external-link">Bernd Funovits</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

