% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/05_estimation_particle.R
\name{ll_pfilter}
\alias{ll_pfilter}
\alias{ll_pfilter.stspmod}
\title{Particle Filter Approximation of Log-Likelihood}
\usage{
ll_pfilter(
  model,
  y,
  N_particles = 1000,
  filter_type = c("sir", "apf"),
  resampling = c("systematic", "multinomial", "stratified"),
  ess_threshold = 0.5,
  N_runs = 10,
  ...
)

\method{ll_pfilter}{stspmod}(
  model,
  y,
  N_particles = 1000,
  filter_type = c("sir", "apf"),
  resampling = c("systematic", "multinomial", "stratified"),
  ess_threshold = 0.5,
  N_runs = 10,
  ...
)
}
\arguments{
\item{filter_type}{Type of particle filter to use for likelihood approximation.
Options: \code{"sir"} (default), \code{"apf"}.}

\item{N_runs}{Number of independent particle filter runs to average over
(default: 10). Averaging reduces the variance of the likelihood estimator.}
}
\value{
Particle filter approximation of the log-likelihood (scaled by \eqn{1/N}).
}
\description{
Approximates the log-likelihood of a state space model using particle filters.
This function is useful for nonlinear/non-Gaussian models where the exact
Kalman filter likelihood is not available.
}
\examples{
# Linear Gaussian example: compare particle filter likelihood with Kalman filter
s = 2
m = 1
n = m
n.obs = 100

tmpl = tmpl_stsp_full(m, n, s, sigma_L = "chol")
model = r_model(tmpl, bpoles = 1, sd = 0.5)
data = sim(model, n.obs = n.obs)

# Kalman filter likelihood (exact)
ll_exact = ll_kf(model, data$y)

# Particle filter likelihood approximation
ll_approx = ll_pf(model, data$y, N_particles = 1000, N_runs = 5)

# Compare (should be close for linear Gaussian model with enough particles)
cat("Exact (Kalman):", ll_exact, "\n")
cat("Approx (PF):", ll_approx, "\n")
cat("Difference:", ll_approx - ll_exact, "\n")
}
\seealso{
\code{\link[=ll_kf]{ll_kf()}} for exact Kalman filter likelihood (linear Gaussian models),
\code{\link[=pf]{pf()}} for particle filtering.
}
