% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/07_comparison_metrics.R
\name{KL_divergence}
\alias{KL_divergence}
\title{Kullbackâ€“Leibler divergence}
\usage{
KL_divergence(model, model_hat)
}
\arguments{
\item{model}{\code{\link[=stspmod]{stspmod()}} object, true model}

\item{model_hat}{\code{\link[=stspmod]{stspmod()}} object, estimated model}
}
\value{
KL divergence.
}
\description{
Compute the Kullback-Leibler divergence between a "true" state space model and
an estimated state space model. The function only works for square systems,
where the "true" model is stable and the estimate is (strictly) miniphase.
}
\details{
The KL divergence is computed as follows. Suppose \eqn{y_t = k(z) u_t}{y[t] = k(z) u[t]},
with \eqn{\mathbf{E} u_t u_t' = \Sigma}{E u[t] u[t]' = \Sigma} is the true model, and
let \eqn{y_t = h(z) u_t}{y[t] = h(z) u[t]}, with \eqn{\mathbf{E} u_t u_t'=\Omega}{E u[t] u[t]'=\Omega}
denote the estimate. W.l.o.g. we assume that the models are in innovation form,
i.e. \eqn{k(0) = h(0) = I}. The procedure computes the covariance matrix,
\eqn{\Delta = \mathbf{E} e_t e_t'}{\Delta = E e[t] e[t]'} say,
of the \emph{one-step-ahead prediction errors} \eqn{e_t = h^{-1}(z) k(z) u_t}{e[t] = h^{-1} (z) k(z) u[t]}
and then the KL divergence
\deqn{
\mathrm{KL} = (1/2)(\mathrm{tr}(\Omega^{-1}\Delta) - m - \ln\det(\Omega^{-1}\Delta)))
}{
KL = (1/2)(tr(\Omega^{-1}\Delta) - m - ln det(\Omega^{-1}\Delta)))
}
Note that this procedure breaks down if the transfer function \eqn{h^{-1}(z) k(z)} is not stable.
Therefore the true models has to be stable and the estimated model has to strictly miniphase.
}
\examples{
# Create a true model and an estimated model
true_model = stspmod(sys = stsp(A = matrix(c(0.5, 0, 0, 0.3), 2, 2),
                                B = matrix(c(1, 0), 2, 1),
                                C = matrix(c(1, 1), 1, 2),
                                D = matrix(1, 1, 1)),
                     sigma_L = matrix(1, 1, 1))
# Create a slightly different estimated model
est_model = stspmod(sys = stsp(A = matrix(c(0.45, 0, 0, 0.35), 2, 2),
                               B = matrix(c(1.1, 0), 2, 1),
                               C = matrix(c(0.9, 1.1), 1, 2),
                               D = matrix(1, 1, 1)),
                    sigma_L = matrix(1.1, 1, 1))
# Compute KL divergence
kl = KL_divergence(true_model, est_model)
kl
}
